# CSP2 æŠ€æœ¯è®¾è®¡æ–‡æ¡£

> Counter-Strike 2 Server Panel - CS2æœåŠ¡å™¨ç®¡ç†é¢æ¿

**ç‰ˆæœ¬**: v0.1.0  
**æ›´æ–°æ—¶é—´**: 2025-10-26  
**ä½œè€…**: CSP2 å¼€å‘å›¢é˜Ÿ

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
3. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
4. [æ ¸å¿ƒæ¨¡å—è®¾è®¡](#æ ¸å¿ƒæ¨¡å—è®¾è®¡)
5. [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
6. [Provideræ‰©å±•æœºåˆ¶](#Provideræ‰©å±•æœºåˆ¶)
7. [å®‰å…¨æ€§è€ƒè™‘](#å®‰å…¨æ€§è€ƒè™‘)
8. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®å®šä½

CSP2 æ˜¯ä¸€ä¸ªé¢å‘ **CS2 æœåŠ¡å™¨ç®¡ç†å‘˜** çš„å¼€æºæ¡Œé¢ç®¡ç†å·¥å…·ï¼Œç±»ä¼¼äºMinecraftçš„PCL2å¯åŠ¨å™¨ã€‚

### 1.2 æ ¸å¿ƒåŠŸèƒ½

- âœ… CS2ä¸“ç”¨æœåŠ¡å™¨çš„å¯åŠ¨ã€åœæ­¢ã€é‡å¯ç®¡ç†
- âœ… å®æ—¶æ—¥å¿—æŸ¥çœ‹å’Œå‘½ä»¤è¡Œäº¤äº’
- âœ… æ’ä»¶æ¡†æ¶ç®¡ç†ï¼ˆMetamodã€CounterStrikeSharpç­‰ï¼‰
- âœ… æ’ä»¶å¸‚åœºï¼ˆæµè§ˆã€å®‰è£…ã€æ›´æ–°ã€å¸è½½æ’ä»¶ï¼‰
- âœ… æœåŠ¡å™¨é…ç½®ç®¡ç†
- âœ… å¤šæœåŠ¡å™¨å®ä¾‹ç®¡ç†
- âœ… ç¤¾åŒºæ‰©å±•æ”¯æŒï¼ˆProvideræœºåˆ¶ï¼‰

### 1.3 è®¾è®¡åŸåˆ™

1. **æ¨¡å—åŒ–**: ä½¿ç”¨Provideræ¨¡å¼ï¼Œå¹³å°ã€æ¡†æ¶ã€æ‰©å±•å®Œå…¨è§£è€¦
2. **å¯æ‰©å±•æ€§**: ç¤¾åŒºå¯ä»¥è½»æ¾æ·»åŠ æ–°å¹³å°ã€æ–°æ¡†æ¶æ”¯æŒ
3. **ç”¨æˆ·å‹å¥½**: ç®€æ´ç¾è§‚çš„UIï¼Œç±»ä¼¼PCL2çš„ä½¿ç”¨ä½“éªŒ
4. **å¼€æºé€æ˜**: MITåè®®ï¼Œæ¬¢è¿ç¤¾åŒºè´¡çŒ®

### 1.4 ç›®æ ‡ç”¨æˆ·

- CS2æœåŠ¡å™¨ç®¡ç†å‘˜
- ç¤¾åŒºæœåŠ¡å™¨è¿è¥è€…
- æ’ä»¶å¼€å‘è€…
- æ¸¸æˆç¤¾åŒº

---

## 2. æŠ€æœ¯æ ˆ

### 2.1 å¼€å‘ç¯å¢ƒ

```
æ“ä½œç³»ç»Ÿ: Windows 10/11 (MVP), Linux (V2)
å¼€å‘å·¥å…·: Visual Studio 2022
.NETç‰ˆæœ¬: .NET 8.0
è¯­è¨€ç‰ˆæœ¬: C# 12
```

### 2.2 æ¡†æ¶å’Œåº“

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| WPF | .NET 8.0 | UIæ¡†æ¶ï¼ˆMVPé˜¶æ®µï¼‰ |
| Avalonia UI | 11.x | è·¨å¹³å°UIï¼ˆV2è¿ç§»ï¼‰ |
| CommunityToolkit.Mvvm | 8.x | MVVMè¾…åŠ©åº“ |
| Microsoft.Extensions.* | 8.x | ä¾èµ–æ³¨å…¥ã€é…ç½®ã€æ—¥å¿— |
| Serilog | 3.x | æ—¥å¿—æ¡†æ¶ |
| System.Text.Json | 8.x | JSONåºåˆ—åŒ– |
| System.IO.Compression | 8.x | ZIPè§£å‹ |
| HttpClient + Polly | 8.x + 8.x | HTTPè¯·æ±‚å’Œé‡è¯•ç­–ç•¥ |

### 2.3 å·¥å…·é“¾

- **SteamCMD**: ä¸‹è½½å’Œæ›´æ–°CS2æœåŠ¡å™¨æ–‡ä»¶
- **GitHub API**: è·å–æ’ä»¶Releaseä¿¡æ¯
- **GitHub Actions**: CI/CDè‡ªåŠ¨åŒ–æ„å»º

---

## 3. ç³»ç»Ÿæ¶æ„

### 3.1 æ€»ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Presentation Layer                     â”‚
â”‚                    (WPF / Avalonia UI)                      â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Server   â”‚  â”‚ Plugin   â”‚  â”‚ Log      â”‚  â”‚ Settings â”‚  â”‚
â”‚  â”‚ View     â”‚  â”‚ Market   â”‚  â”‚ Console  â”‚  â”‚ View     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ MVVM Binding
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Application Layer                      â”‚
â”‚                    (ViewModels + Commands)                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ServerVM     â”‚  â”‚ PluginMarket â”‚  â”‚ SettingsVM   â”‚    â”‚
â”‚  â”‚              â”‚  â”‚ VM           â”‚  â”‚              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ Service Layer
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Business Layer                       â”‚
â”‚                     (Core Services)                         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Server       â”‚  â”‚ Plugin       â”‚  â”‚ Provider     â”‚    â”‚
â”‚  â”‚ Manager      â”‚  â”‚ Manager      â”‚  â”‚ Registry     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ SteamCMD     â”‚  â”‚ Repository   â”‚  â”‚ Config       â”‚    â”‚
â”‚  â”‚ Service      â”‚  â”‚ Service      â”‚  â”‚ Manager      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ Provider Interface
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Provider Layer                         â”‚
â”‚                   (Platform & Framework)                    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Windows      â”‚  â”‚ Linux        â”‚  â”‚ Docker       â”‚    â”‚
â”‚  â”‚ Provider     â”‚  â”‚ Provider     â”‚  â”‚ Provider     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ CSS          â”‚  â”‚ Metamod      â”‚  â”‚ Swiftly      â”‚    â”‚
â”‚  â”‚ Provider     â”‚  â”‚ Provider     â”‚  â”‚ Provider     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 åˆ†å±‚èŒè´£

#### **Presentation Layer (è¡¨ç¤ºå±‚)**
- è´Ÿè´£UIæ¸²æŸ“å’Œç”¨æˆ·äº¤äº’
- ä½¿ç”¨MVVMæ¨¡å¼ï¼ŒViewå’ŒViewModelåˆ†ç¦»
- ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘

#### **Application Layer (åº”ç”¨å±‚)**
- ViewModelå¤„ç†UIé€»è¾‘
- å‘½ä»¤ç»‘å®šå’Œæ•°æ®ç»‘å®š
- è°ƒç”¨Business Layerçš„æœåŠ¡

#### **Business Layer (ä¸šåŠ¡å±‚)**
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- æœåŠ¡å™¨ç®¡ç†ã€æ’ä»¶ç®¡ç†ç­‰
- ä¸ä¾èµ–å…·ä½“çš„UIæ¡†æ¶

#### **Provider Layer (æä¾›è€…å±‚)**
- æŠ½è±¡å¹³å°å’Œæ¡†æ¶å·®å¼‚
- å¯æ’æ‹”çš„Providerå®ç°
- ç¤¾åŒºå¯æ‰©å±•

---

## 4. æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 4.1 æ¨¡å—åˆ’åˆ†

#### **CSP2.Core (æ ¸å¿ƒåº“)**
- å®šä¹‰æ‰€æœ‰æŠ½è±¡æ¥å£
- æ•°æ®æ¨¡å‹
- æ ¸å¿ƒæœåŠ¡å®ç°
- Provideræ³¨å†Œæœºåˆ¶

#### **CSP2.Providers (æä¾›è€…å®ç°)**
- Windowså¹³å°æ”¯æŒ
- CounterStrikeSharpæ¡†æ¶æ”¯æŒ
- Metamodæ¡†æ¶æ”¯æŒ
- ï¼ˆæœªæ¥ï¼šLinuxã€Swiftlyç­‰ï¼‰

#### **CSP2.Desktop (æ¡Œé¢åº”ç”¨)**
- WPFç•Œé¢
- ViewModels
- åº”ç”¨ç¨‹åºå…¥å£
- èµ„æºæ–‡ä»¶

#### **CSP2.SDK (æ‰©å±•SDK)**
- ä¾›ç¤¾åŒºå¼€å‘æ‰©å±•çš„SDK
- æ’ä»¶æ¥å£å®šä¹‰
- ç¤ºä¾‹ä»£ç 

---

### 4.2 ServerManager (æœåŠ¡å™¨ç®¡ç†å™¨)

**èŒè´£**: ç®¡ç†CS2æœåŠ¡å™¨çš„ç”Ÿå‘½å‘¨æœŸ

```csharp
public interface IServerManager
{
    // è·å–æ‰€æœ‰æœåŠ¡å™¨
    Task<List<Server>> GetServersAsync();
    
    // æ·»åŠ æœåŠ¡å™¨
    Task<Server> AddServerAsync(ServerConfig config);
    
    // å¯åŠ¨æœåŠ¡å™¨
    Task<ServerProcess> StartServerAsync(string serverId);
    
    // åœæ­¢æœåŠ¡å™¨
    Task StopServerAsync(string serverId, bool force = false);
    
    // é‡å¯æœåŠ¡å™¨
    Task RestartServerAsync(string serverId);
    
    // å‘é€å‘½ä»¤
    Task SendCommandAsync(string serverId, string command);
    
    // äº‹ä»¶ï¼šæ—¥å¿—è¾“å‡º
    event EventHandler<LogReceivedEventArgs> LogReceived;
    
    // äº‹ä»¶ï¼šæœåŠ¡å™¨çŠ¶æ€å˜åŒ–
    event EventHandler<ServerStatusChangedEventArgs> StatusChanged;
}
```

**å®ç°è¦ç‚¹**:
- ä½¿ç”¨`IPlatformProvider`å¯åŠ¨è¿›ç¨‹
- å¼‚æ­¥è¯»å–æ ‡å‡†è¾“å‡ºä½œä¸ºæ—¥å¿—
- æ”¯æŒæ ‡å‡†è¾“å…¥å‘é€å‘½ä»¤
- çŠ¶æ€ç®¡ç†ï¼šåœæ­¢ã€å¯åŠ¨ä¸­ã€è¿è¡Œä¸­ã€åœæ­¢ä¸­ã€å´©æºƒ

---

### 4.3 PluginManager (æ’ä»¶ç®¡ç†å™¨)

**èŒè´£**: ç®¡ç†æ’ä»¶çš„å®‰è£…ã€æ›´æ–°ã€å¸è½½

```csharp
public interface IPluginManager
{
    // è·å–å¯ç”¨æ’ä»¶åˆ—è¡¨ï¼ˆä»ä»“åº“ï¼‰
    Task<List<PluginInfo>> GetAvailablePluginsAsync();
    
    // è·å–å·²å®‰è£…æ’ä»¶
    Task<List<InstalledPlugin>> GetInstalledPluginsAsync(string serverId);
    
    // å®‰è£…æ’ä»¶
    Task<InstallResult> InstallPluginAsync(string serverId, string pluginId, 
        IProgress<InstallProgress>? progress = null);
    
    // æ›´æ–°æ’ä»¶
    Task<InstallResult> UpdatePluginAsync(string serverId, string pluginId);
    
    // å¸è½½æ’ä»¶
    Task<bool> UninstallPluginAsync(string serverId, string pluginId);
    
    // å¯ç”¨/ç¦ç”¨æ’ä»¶
    Task<bool> SetPluginEnabledAsync(string serverId, string pluginId, bool enabled);
}
```

**å®ç°è¦ç‚¹**:
- å§”æ‰˜ç»™å¯¹åº”çš„`IFrameworkProvider`æ‰§è¡Œ
- å¤„ç†ä¾èµ–å…³ç³»ï¼ˆå¦‚CSSä¾èµ–Metamodï¼‰
- æ”¯æŒè¿›åº¦æŠ¥å‘Š
- é”™è¯¯å¤„ç†å’Œå›æ»š

---

### 4.4 ProviderRegistry (æä¾›è€…æ³¨å†Œä¸­å¿ƒ)

**èŒè´£**: ç®¡ç†æ‰€æœ‰Providerçš„æ³¨å†Œå’Œè·å–

```csharp
public class ProviderRegistry
{
    // æ³¨å†Œå¹³å°æä¾›è€…
    void RegisterPlatformProvider(IPlatformProvider provider);
    
    // æ³¨å†Œæ¡†æ¶æä¾›è€…
    void RegisterFrameworkProvider(IFrameworkProvider provider);
    
    // è‡ªåŠ¨é€‰æ‹©æœ€ä½³å¹³å°Provider
    IPlatformProvider GetBestPlatformProvider();
    
    // è·å–æŒ‡å®šæ¡†æ¶Provider
    IFrameworkProvider? GetFrameworkProvider(string frameworkId);
    
    // åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ¡†æ¶
    List<FrameworkInfo> GetAvailableFrameworks();
    
    // ä»ç›®å½•åŠ è½½Providerï¼ˆè¿è¡Œæ—¶æ’ä»¶ï¼‰
    Task LoadProvidersFromDirectoryAsync(string directory);
}
```

---

### 4.5 SteamCmdService (SteamCMDæœåŠ¡)

**èŒè´£**: ä¸‹è½½å’Œæ›´æ–°CS2æœåŠ¡å™¨æ–‡ä»¶

```csharp
public interface ISteamCmdService
{
    // æ£€æŸ¥SteamCMDæ˜¯å¦å·²å®‰è£…
    Task<bool> IsSteamCmdInstalledAsync();
    
    // ä¸‹è½½SteamCMDï¼ˆå¦‚æœéœ€è¦ï¼‰
    Task<bool> DownloadSteamCmdAsync(IProgress<DownloadProgress>? progress = null);
    
    // å®‰è£…/æ›´æ–°CS2æœåŠ¡å™¨
    Task<bool> InstallOrUpdateServerAsync(string installPath, 
        IProgress<InstallProgress>? progress = null);
    
    // éªŒè¯æœåŠ¡å™¨æ–‡ä»¶å®Œæ•´æ€§
    Task<bool> ValidateServerFilesAsync(string installPath);
}
```

**å®ç°è¦ç‚¹**:
- ç”¨æˆ·å¯ä»¥é€‰æ‹©ï¼š
  - ä½¿ç”¨å·²æœ‰çš„CS2å®‰è£…ï¼ˆæ¸¸æˆæœ¬èº«å°±èƒ½å½“æœåŠ¡å™¨ï¼‰
  - é€šè¿‡SteamCMDä¸‹è½½ä¸“ç”¨æœåŠ¡å™¨
- æ”¯æŒæ–­ç‚¹ç»­ä¼ 
- è¿›åº¦å›è°ƒ

---

### 4.6 PluginRepositoryService (æ’ä»¶ä»“åº“æœåŠ¡)

**èŒè´£**: ä»GitHubä»“åº“è·å–æ’ä»¶åˆ—è¡¨

```csharp
public interface IPluginRepositoryService
{
    // è·å–æ’ä»¶æ¸…å•ï¼ˆå¸¦ç¼“å­˜ï¼‰
    Task<PluginManifest> GetManifestAsync(bool forceRefresh = false);
    
    // æœç´¢æ’ä»¶
    Task<List<PluginInfo>> SearchPluginsAsync(string keyword);
    
    // æŒ‰åˆ†ç±»è¿‡æ»¤
    Task<List<PluginInfo>> GetPluginsByCategoryAsync(string category);
    
    // è·å–æ’ä»¶è¯¦æƒ…
    Task<PluginInfo?> GetPluginDetailsAsync(string pluginId);
    
    // æ£€æŸ¥æ’ä»¶æ›´æ–°
    Task<Dictionary<string, string>> CheckUpdatesAsync(List<InstalledPlugin> installed);
}
```

**æ•°æ®æ¥æº**:
- ~~ç¬¬ä¸€é˜¶æ®µï¼šæœ¬åœ°JSONæ–‡ä»¶ï¼ˆæ¨¡æ‹Ÿæ•°æ®ï¼‰~~ âœ… å·²å®Œæˆ
- âœ… **å½“å‰å®ç°**ï¼šä»GitHubä»“åº“è¯»å–manifest.json
- âœ… å¤šçº§ç¼“å­˜æœºåˆ¶ï¼Œç¦»çº¿å¯ç”¨
- âœ… æ”¯æŒè‡ªå®šä¹‰ä»“åº“æºå’Œé•œåƒé…ç½®

**GitHubæ’ä»¶æºæ¶æ„** (2025-10-27æ›´æ–°):

CSP2ç°å·²å®ç°å®Œæ•´çš„GitHubæ’ä»¶æºç³»ç»Ÿï¼Œæ’ä»¶å…ƒæ•°æ®æ‰˜ç®¡åœ¨ç‹¬ç«‹ä»“åº“ï¼š

```
csp2-plugin-repository (GitHub)
    â†“ è‡ªåŠ¨åŒ–CI/CD (GitHub Actions)
    â†“ CDNåŠ é€Ÿ (jsDelivr / GitHub Pages)
    â†“ å¤šæºé™çº§ HTTP GET
CSP2.Core.Services.PluginRepositoryService
    â†“ ç¼“å­˜åˆ°æœ¬åœ°
data/plugins-cache.json
    â†“ è¯»å–
PluginMarketViewModel (UI)
```

**å¤šçº§é™çº§ç­–ç•¥**:
1. **å†…å­˜ç¼“å­˜**: 1å°æ—¶å†…ç›´æ¥è¿”å›ï¼Œæ— ç½‘ç»œè¯·æ±‚
2. **è¿œç¨‹æ‹‰å–ï¼ˆå¤šæºé™çº§ï¼‰**: 
   - ä¼˜å…ˆï¼šç”¨æˆ·è‡ªå®šä¹‰æºï¼ˆå¦‚æœ‰é…ç½®ï¼‰
   - é™çº§1ï¼šjsDelivr CDNï¼ˆé€Ÿåº¦å¿«ï¼Œæ¨èï¼‰
   - é™çº§2ï¼šGitHub Pagesï¼ˆå¤‡ç”¨ï¼‰
   - é™çº§3ï¼šGitHub Rawï¼ˆæœ€åé™çº§ï¼‰
3. **æœ¬åœ°ç¼“å­˜**: æ‰€æœ‰è¿œç¨‹æºå¤±è´¥æ—¶ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ–‡ä»¶
4. **ç©ºé»˜è®¤æ¸…å•**: å®Œå…¨ç¦»çº¿ä¸”æ— ç¼“å­˜æ—¶è¿”å›ç©ºåˆ—è¡¨

**é»˜è®¤CDNç«¯ç‚¹**ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰:
```
1. https://cdn.jsdelivr.net/gh/yichen11818/csp2-plugin-repository@main/manifest.json
2. https://yichen11818.github.io/csp2-plugin-repository/manifest.json  
3. https://raw.githubusercontent.com/yichen11818/csp2-plugin-repository/main/manifest.json
```

**è‡ªå®šä¹‰ä»“åº“æºé…ç½®**:

åœ¨ `data/settings.json` ä¸­é…ç½®è‡ªå®šä¹‰æ’ä»¶æºï¼š

```json
{
  "repository": {
    "url": "https://your-custom-cdn.com/manifest.json",
    "mirrorUrls": [
      "https://mirror1.example.com/manifest.json",
      "https://mirror2.example.com/manifest.json"
    ],
    "cacheExpiration": 3600
  }
}
```

é…ç½®è¯´æ˜ï¼š
- `url`: ä¸»ä»“åº“URLï¼Œç•™ç©ºåˆ™ä½¿ç”¨å®˜æ–¹é»˜è®¤æº
- `mirrorUrls`: é•œåƒæºåˆ—è¡¨ï¼Œä½œä¸ºé™çº§å¤‡é€‰
- `cacheExpiration`: ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ï¼Œé»˜è®¤3600ï¼ˆ1å°æ—¶ï¼‰

**è‡ªåŠ¨åŒ–æ›´æ–°æœºåˆ¶**:
- GitHub Actionsæ¯6å°æ—¶è‡ªåŠ¨æ£€æµ‹æ’ä»¶æ–°ç‰ˆæœ¬
- æ”¯æŒç¤¾åŒºPRæäº¤æ–°æ’ä»¶
- è‡ªåŠ¨éªŒè¯JSON Schemaå’Œä¸‹è½½é“¾æ¥
- æ’ä»¶ä»“åº“åœ°å€: [csp2-plugin-repository](https://github.com/yichen11818/csp2-plugin-repository)

**æ’ä»¶å•†åº—UIæ”¯æŒçš„å­—æ®µ** (2025-10-28æ›´æ–°):

æ’ä»¶å•†åº—ç°å·²æ”¯æŒ Manifest v2.0 çš„å¤§éƒ¨åˆ†å­—æ®µï¼Œåœ¨æ’ä»¶å¡ç‰‡ä¸­æ˜¾ç¤ºï¼š

âœ… **å½“å‰æ˜¾ç¤ºçš„å­—æ®µ**:
- `name` - æ’ä»¶åç§°ï¼ˆæ ‡é¢˜ï¼‰
- `author.name` - ä½œè€…åç§°
- `version` - ç‰ˆæœ¬å·ï¼ˆæ ‡ç­¾ï¼‰
- `descriptionZh` / `description` - ä¸­æ–‡/è‹±æ–‡æè¿°
- `framework` - æ¡†æ¶æ ‡ç­¾ï¼ˆå¦‚ counterstrikesharpï¼‰
- `featured` - æ¨èæ ‡è®°ï¼ˆâ­ æ¨èï¼‰
- `verified` - å·²éªŒè¯å¾½ç« ï¼ˆâœ“ å·²éªŒè¯ï¼‰
- `officialSupport` - å®˜æ–¹æ”¯æŒæ ‡è®°ï¼ˆâš¡ å®˜æ–¹æ”¯æŒï¼‰
- `downloads.total` - æ€»ä¸‹è½½æ¬¡æ•°
- `rating.average` / `rating.count` - è¯„åˆ†å’Œè¯„åˆ†äººæ•°

**æ¡†æ¶ç®¡ç†åŠŸèƒ½** (2025-10-27æ›´æ–°):

æ’ä»¶å•†åº—é¡µé¢ç°å·²é›†æˆæ¡†æ¶ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æŒä¸€é”®å®‰è£…CSSå’ŒMetamodï¼š

âœ… **æ¡†æ¶å®‰è£…åŠŸèƒ½**:
- `Metamod:Source` - æ’ä»¶åŠ è½½å™¨åŸºç¡€æ¡†æ¶
  - ä» AlliedModders å®˜ç½‘è‡ªåŠ¨ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
  - ä¸‹è½½ ZIP æ ¼å¼ï¼ˆå·²åŒ…å« `addons/` ç›®å½•ç»“æ„ï¼‰
  - ç›´æ¥è§£å‹åˆ° `game/csgo/`ï¼Œè‡ªåŠ¨åˆ›å»º `addons/metamod/`
  - è‡ªåŠ¨ä¿®æ”¹ `gameinfo.gi` åŠ è½½Metamod
  - æ˜¾ç¤ºå®‰è£…çŠ¶æ€å’Œç‰ˆæœ¬ä¿¡æ¯

- `CounterStrikeSharp` - C#æ’ä»¶æ¡†æ¶
  - ä» GitHub è‡ªåŠ¨ä¸‹è½½ `counterstrikesharp-with-runtime-windows.zip`
  - ä¸‹è½½ ZIP æ ¼å¼ï¼ˆå·²åŒ…å« `addons/` ç›®å½•ç»“æ„ï¼‰
  - ç›´æ¥è§£å‹åˆ° `game/csgo/`ï¼Œè‡ªåŠ¨åˆ›å»º `addons/counterstrikesharp/`
  - è‡ªåŠ¨æ£€æµ‹å¹¶å®‰è£…Metamodä¾èµ–
  - æ”¯æŒè¿›åº¦æ˜¾ç¤ºå’Œé”™è¯¯å¤„ç†

âœ… **æ—¥å¿—è®°å½•**:
- ä½¿ç”¨æ ‡å‡†çš„ `ILogger` æ¥å£è®°å½•å®‰è£…è¿‡ç¨‹
- è¯¦ç»†æ—¥å¿—åŒ…æ‹¬ï¼š
  - ä¸‹è½½ URL å’Œæ–‡ä»¶å
  - ä¸´æ—¶ä¸‹è½½è·¯å¾„
  - æœ€ç»ˆå®‰è£…ä½ç½®ï¼ˆ`game/csgo/addons/[framework]`ï¼‰
  - ZIP æ–‡ä»¶åŒ…å«çš„æ¡ç›®æ•°
  - å…³é”®æ–‡ä»¶çš„è§£å‹è¿‡ç¨‹ï¼ˆ.dll, .so, .vdfï¼‰
  - å®‰è£…çš„ä¸»è¦æ–‡ä»¶åŠå¤§å°
  - åˆ›å»ºçš„å­ç›®å½•ç»“æ„
  - ç‰ˆæœ¬ä¿¡æ¯ä¿å­˜
  - ä¸´æ—¶æ–‡ä»¶æ¸…ç†çŠ¶æ€

**å®‰è£…æµç¨‹è¯´æ˜**:
1. ZIPæ–‡ä»¶å†…éƒ¨ç»“æ„ï¼š`addons/counterstrikesharp/...` æˆ– `addons/metamod/...`
2. è§£å‹ç›®æ ‡ï¼š`{æœåŠ¡å™¨è·¯å¾„}/game/csgo/`
3. è§£å‹åè‡ªåŠ¨å½¢æˆï¼š`game/csgo/addons/counterstrikesharp/` å’Œ `game/csgo/addons/metamod/`
4. æ— éœ€æ‰‹åŠ¨å¤„ç†è·¯å¾„ï¼Œå®Œå…¨è‡ªåŠ¨åŒ–

**æ¡†æ¶å®‰è£…ç•Œé¢**:
- ä½ç½®ï¼šæ’ä»¶å•†åº—é¡µé¢é¡¶éƒ¨
- æ ·å¼ï¼šå¡ç‰‡å¼å¸ƒå±€ï¼Œå¹¶æ’æ˜¾ç¤ºä¸¤ä¸ªæ¡†æ¶
- åŠŸèƒ½ï¼š
  - âœ… å®æ—¶æ˜¾ç¤ºå®‰è£…çŠ¶æ€ï¼ˆå·²å®‰è£…/æœªå®‰è£…ï¼‰
  - âœ… æ˜¾ç¤ºå·²å®‰è£…ç‰ˆæœ¬å·
  - âœ… ä¸€é”®å®‰è£…/é‡æ–°å®‰è£…æŒ‰é’®
  - âœ… ä¾èµ–å…³ç³»æç¤ºï¼ˆCSSä¾èµ–Metamodï¼‰
  - âœ… å®‰è£…è¿›åº¦å®æ—¶æ›´æ–°
  - âœ… è‡ªåŠ¨åˆ‡æ¢æœåŠ¡å™¨æ—¶åˆ·æ–°çŠ¶æ€

ğŸ”œ **è®¡åˆ’æ”¯æŒçš„å­—æ®µ**:
- `tags` - æ ‡ç­¾åˆ—è¡¨ï¼ˆç”¨äºç­›é€‰å’Œå±•ç¤ºç‰¹æ€§ï¼‰
- `links` - ç›¸å…³é“¾æ¥ï¼ˆä¸»é¡µã€æ–‡æ¡£ã€é—®é¢˜åé¦ˆï¼‰
- `compatibility.platforms` - æ”¯æŒçš„å¹³å°å›¾æ ‡
- `frameworkVersion` - æ¡†æ¶ç‰ˆæœ¬è¦æ±‚æç¤º
- `dependencies` - ä¾èµ–æ’ä»¶åˆ—è¡¨
- `media.screenshots` - æ’ä»¶æˆªå›¾é¢„è§ˆ

**CDNé…ç½®å»ºè®®**:

| CDNæœåŠ¡ | URLæ ¼å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|---------|---------|------|------|
| jsDelivr | `https://cdn.jsdelivr.net/gh/owner/repo@branch/file` | å…¨çƒCDNï¼Œé€Ÿåº¦å¿« | éƒ¨åˆ†åœ°åŒºå¯èƒ½è¢«é™åˆ¶ |
| GitHub Pages | `https://owner.github.io/repo/file` | GitHubå®˜æ–¹ï¼Œç¨³å®š | éœ€è¦å•ç‹¬é…ç½® |
| Cloudflare Pages | `https://repo.pages.dev/file` | å›½å†…é€Ÿåº¦å¿« | éœ€è¦é¢å¤–éƒ¨ç½² |
| è‡ªå»ºCDN | è‡ªå®šä¹‰åŸŸå | å®Œå…¨å¯æ§ | éœ€è¦è‡ªå·±ç»´æŠ¤ |

---

## 5. æ•°æ®æ¨¡å‹

### 5.1 Server (æœåŠ¡å™¨å®ä½“)

```csharp
public class Server
{
    public string Id { get; set; }              // å”¯ä¸€æ ‡è¯†ï¼ˆGUIDï¼‰
    public string Name { get; set; }            // æœåŠ¡å™¨åç§°
    public string InstallPath { get; set; }     // å®‰è£…è·¯å¾„
    public ServerStatus Status { get; set; }    // å½“å‰çŠ¶æ€
    public ServerConfig Config { get; set; }    // é…ç½®ä¿¡æ¯
    public DateTime CreatedAt { get; set; }
    public DateTime? LastStartedAt { get; set; }
}

public enum ServerStatus
{
    Stopped,        // å·²åœæ­¢
    Starting,       // å¯åŠ¨ä¸­
    Running,        // è¿è¡Œä¸­
    Stopping,       // åœæ­¢ä¸­
    Crashed         // å´©æºƒ
}

public class ServerConfig
{
    // åŸºç¡€é…ç½®
    public string IpAddress { get; set; } = "0.0.0.0";
    public int Port { get; set; } = 27015;
    public string Map { get; set; } = "de_dust2";
    public string MapGroup { get; set; } = "mg_active";
    public int MaxPlayers { get; set; } = 10;
    public int GameType { get; set; } = 0;
    public int GameMode { get; set; } = 1;
    public int TickRate { get; set; } = 128;
    
    // æœåŠ¡å™¨èº«ä»½
    public string? ServerName { get; set; }
    public string? ServerPassword { get; set; }
    public string? RconPassword { get; set; }
    public string? SteamToken { get; set; }
    
    // ç½‘ç»œè®¾ç½®
    public bool IsLanMode { get; set; } = false;
    public bool InsecureMode { get; set; } = false;
    
    // æ€§èƒ½ä¼˜åŒ–
    public bool EnableConsole { get; set; } = true;
    public string ProcessPriority { get; set; } = "normal";
    public int? MaxFps { get; set; }
    public int? ThreadCount { get; set; }
    public bool DisableHltv { get; set; } = false;
    
    // æ¸¸æˆè§„åˆ™
    public bool EnableCheats { get; set; } = false;
    public int BotQuota { get; set; } = 0;
    public int BotDifficulty { get; set; } = 2;
    public int? KickIdleTime { get; set; }
    
    // æ—¥å¿—è®¾ç½®
    public bool EnableLogging { get; set; } = true;
    public bool ConsoleLogToFile { get; set; } = false;
    public bool LogEcho { get; set; } = true;
    
    // è‡ªå®šä¹‰å‚æ•°
    public Dictionary<string, string> CustomArgs { get; set; } = new();
}
```

---

### 5.2 Plugin (æ’ä»¶ä¿¡æ¯)

**2025-10-28æ›´æ–°**: å·²å‡çº§ä¸º Manifest v2.0 æ ¼å¼ï¼Œæ”¯æŒæ›´ä¸°å¯Œçš„æ’ä»¶å…ƒæ•°æ®ã€‚

```csharp
public class PluginInfo
{
    // åŸºç¡€ä¿¡æ¯
    public string Id { get; set; }              // å”¯ä¸€æ ‡è¯†ï¼ˆå°å†™ï¼‰
    public string Name { get; set; }            // æ˜¾ç¤ºåç§°
    public string? Slug { get; set; }           // URLå‹å¥½çš„æ ‡è¯†ç¬¦
    public AuthorInfo? Author { get; set; }     // ä½œè€…ä¿¡æ¯ï¼ˆå¯¹è±¡ï¼‰
    
    // æè¿°ä¿¡æ¯
    public string Description { get; set; }     // è‹±æ–‡æè¿°
    public string? DescriptionZh { get; set; }  // ä¸­æ–‡æè¿°ï¼ˆå¯é€‰ï¼‰
    
    // æ¡†æ¶å’Œä¾èµ–
    public string Framework { get; set; }       // counterstrikesharp, metamod, etc.
    public string? FrameworkVersion { get; set; } // æ¡†æ¶ç‰ˆæœ¬è¦æ±‚ï¼ˆå¦‚ >=1.0.0ï¼‰
    public string[] Dependencies { get; set; } = [];
    
    // åˆ†ç±»å’Œæ ‡ç­¾
    public string Category { get; set; }        // gameplay, admin, utility, etc.
    public string[] Tags { get; set; } = [];
    
    // ç‰ˆæœ¬ä¿¡æ¯
    public string Version { get; set; }
    public string? Changelog { get; set; }      // æ›´æ–°æ—¥å¿—é“¾æ¥
    
    // ä¸‹è½½ä¿¡æ¯ï¼ˆåµŒå¥—å¯¹è±¡ï¼‰
    public DownloadInfo? Download { get; set; } // { url, size, hash }
    public string DownloadUrl => Download?.Url ?? "";  // å‘åå…¼å®¹
    public long DownloadSize => Download?.Size ?? 0;   // å‘åå…¼å®¹
    
    // ä»“åº“ä¿¡æ¯
    public RepositoryInfo? Repository { get; set; }  // { type, owner, repo, branch }
    
    // å®‰è£…å’Œé…ç½®
    public InstallationInfo? Installation { get; set; }  // { type, targetPath, files }
    public ConfigurationInfo? Configuration { get; set; } // { required, files, documentation }
    
    // é“¾æ¥ä¿¡æ¯
    public LinksInfo? Links { get; set; }       // { homepage, documentation, issues, discord }
    
    // åª’ä½“ä¿¡æ¯
    public MediaInfo? Media { get; set; }       // { screenshots, video, icon }
    
    // çŠ¶æ€æ ‡è®°
    public bool Verified { get; set; }          // æ˜¯å¦éªŒè¯è¿‡
    public bool Featured { get; set; }          // æ˜¯å¦æ¨è
    public bool OfficialSupport { get; set; }   // æ˜¯å¦å®˜æ–¹æ”¯æŒ
    
    // ç»Ÿè®¡ä¿¡æ¯ï¼ˆåµŒå¥—å¯¹è±¡ï¼‰
    public DownloadsInfo? Downloads { get; set; }  // { total, lastMonth }
    public RatingInfo? Rating { get; set; }        // { average, count }
    
    // å…¼å®¹æ€§ä¿¡æ¯
    public CompatibilityInfo? Compatibility { get; set; }  // { cs2Version, platforms }
    
    // å…ƒæ•°æ®
    public MetadataInfo? Metadata { get; set; }  // { addedAt, updatedAt, lastChecked }
}

// åµŒå¥—ç±»å‹å®šä¹‰
public class AuthorInfo
{
    public string Name { get; set; }     // ä½œè€…åç§°
    public string? Github { get; set; }  // GitHubç”¨æˆ·å
    public string? Email { get; set; }   // ç”µå­é‚®ä»¶
}

public class DownloadInfo
{
    public string Url { get; set; }      // ä¸‹è½½URL
    public long Size { get; set; }       // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
    public string? Hash { get; set; }    // æ–‡ä»¶å“ˆå¸Œå€¼
}

public class RepositoryInfo
{
    public string Type { get; set; } = "github";  // github, gitlab
    public string? Owner { get; set; }            // ä»“åº“æ‰€æœ‰è€…
    public string? Repo { get; set; }             // ä»“åº“åç§°
    public string? Branch { get; set; }           // åˆ†æ”¯æˆ–æ ‡ç­¾
}

public class DownloadsInfo
{
    public int Total { get; set; }      // æ€»ä¸‹è½½æ¬¡æ•°
    public int LastMonth { get; set; }  // æœ€è¿‘ä¸€ä¸ªæœˆä¸‹è½½æ¬¡æ•°
}

public class RatingInfo
{
    public float Average { get; set; }  // å¹³å‡è¯„åˆ†ï¼ˆ0-5ï¼‰
    public int Count { get; set; }      // è¯„åˆ†æ•°é‡
}

public class CompatibilityInfo
{
    public string? Cs2Version { get; set; }    // CS2ç‰ˆæœ¬è¦æ±‚
    public string[]? Platforms { get; set; }   // æ”¯æŒçš„å¹³å°ï¼ˆwindows, linuxï¼‰
}

public class InstalledPlugin
{
    public string Id { get; set; }
    public string Name { get; set; }
    public string Version { get; set; }
    public string Framework { get; set; }
    public bool Enabled { get; set; }
    public string InstallPath { get; set; }
    public DateTime InstalledAt { get; set; }
}
```

---

### 5.3 FrameworkInfo (æ¡†æ¶ä¿¡æ¯)

```csharp
public class FrameworkInfo
{
    public string Id { get; set; }              // counterstrikesharp, metamod
    public string Name { get; set; }            // CounterStrikeSharp
    public string ShortName { get; set; }       // CSS
    public string Description { get; set; }
    
    public string[] Dependencies { get; set; } = [];
    
    public string InstallPath { get; set; }     // ç›¸å¯¹äºæœåŠ¡å™¨æ ¹ç›®å½•
    public string PluginPath { get; set; }
    public string ConfigPath { get; set; }
    
    public string[] SupportedPlatforms { get; set; } = [];
    
    public string RepositoryUrl { get; set; }
    public string DocumentationUrl { get; set; }
    
    public string? InstalledVersion { get; set; }
    public string? LatestVersion { get; set; }
}
```

---

### 5.4 æ¡†æ¶è‡ªåŠ¨å®‰è£…å®ç° (2025-10-28æ›´æ–°)

**CounterStrikeSharp å®‰è£…é€»è¾‘**:

1. **ç‰ˆæœ¬è·å–**: é€šè¿‡ GitHub API è·å–æœ€æ–° Release
   ```
   GET https://api.github.com/repos/roflmuffin/CounterStrikeSharp/releases/latest
   ```

2. **ä¸‹è½½æ–‡ä»¶**: ä» Release Assets ä¸­æŸ¥æ‰¾ Windows ç‰ˆæœ¬çš„ ZIP æ–‡ä»¶
   - æ–‡ä»¶ååŒ…å« "windows" ä¸”ä»¥ ".zip" ç»“å°¾
   - æ”¯æŒè¿›åº¦æŠ¥å‘Šï¼ˆ20-60%ï¼‰

3. **è§£å‹å®‰è£…**: 
   - ç›®æ ‡è·¯å¾„: `game/csgo/addons/counterstrikesharp`
   - è‡ªåŠ¨å¤„ç†è·¯å¾„æ˜ å°„ï¼ˆè·³è¿‡ `addons/counterstrikesharp/` å‰ç¼€ï¼‰
   - å¦‚å·²å­˜åœ¨åˆ™å…ˆå¤‡ä»½ï¼ˆæ·»åŠ æ—¶é—´æˆ³ï¼‰
   - **å…³é”®æ–‡ä»¶ä½ç½®**: 
     - Windows: `bin/win64/counterstrikesharp.dll`
     - Linux: `bin/linuxsteamrt64/counterstrikesharp.so`

4. **ç‰ˆæœ¬è®°å½•**: ä¿å­˜ç‰ˆæœ¬ä¿¡æ¯åˆ° `version.txt`

**å®‰è£…çŠ¶æ€æ£€æŸ¥ä¿®å¤** (2025-10-28):

é—®é¢˜ï¼šå®‰è£…æˆåŠŸåæ£€æŸ¥æ˜¾ç¤ºæœªå®‰è£…

åŸå› ï¼š`IsInstalledAsync`æ£€æŸ¥çš„æ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®
- æ—§ä»£ç æ£€æŸ¥ï¼š`counterstrikesharp/CounterStrikeSharp.dll`ï¼ˆæ ¹ç›®å½•ï¼‰
- å®é™…ä½ç½®ï¼š`counterstrikesharp/bin/win64/counterstrikesharp.dll`ï¼ˆå­ç›®å½•ï¼‰

ä¿®å¤ï¼šæ›´æ–°æ£€æŸ¥é€»è¾‘ä»¥åŒ¹é…å®é™…æ–‡ä»¶ç»“æ„
```csharp
// ä¿®å¤åçš„æ£€æŸ¥é€»è¾‘
var dllPath = Path.Combine(cssPath, "bin", "win64", "counterstrikesharp.dll");
var soPath = Path.Combine(cssPath, "bin", "linuxsteamrt64", "counterstrikesharp.so");
return Directory.Exists(cssPath) && (File.Exists(dllPath) || File.Exists(soPath));
```

**Metamod:Source å®‰è£…é€»è¾‘**:

1. **ç‰ˆæœ¬è·å–**: ä¸¤æ­¥è·å–æœ€æ–°ç‰ˆæœ¬
   ```
   æ­¥éª¤1: GET https://mms.alliedmods.net/mmsdrop/2.0/mmsource-latest-windows
   è¿”å›: mmsource-2.0.0-git1367-windows.zip
   
   æ­¥éª¤2: GET https://mms.alliedmods.net/mmsdrop/2.0/mmsource-2.0.0-git1367-windows.zip
   ä¸‹è½½å®é™…æ–‡ä»¶
   ```
   - é€šè¿‡ latest info URL è·å–å®é™…æ–‡ä»¶å
   - ä»æ–‡ä»¶åä¸­æå–ç‰ˆæœ¬å·ï¼ˆå¦‚ `2.0.0-git1367`ï¼‰
   - æ„å»ºå®Œæ•´ä¸‹è½½ URL

2. **è‡ªåŠ¨è§£å‹**: 
   - ç›®æ ‡è·¯å¾„: `game/csgo/addons/metamod`
   - å¤„ç†è·¯å¾„å‰ç¼€æ˜ å°„
   - ä¿å­˜çœŸå®ç‰ˆæœ¬å·åˆ° `version.txt`
   - **å…³é”®æ–‡ä»¶ä½ç½®**:
     - Windows: `bin/metamod.2.bgt.dll` å’Œ `bin/win64/server.dll`
     - Linux: `bin/linuxsteamrt64/metamod.so`

3. **é…ç½®é›†æˆ**: 
   - è‡ªåŠ¨ä¿®æ”¹ `gameinfo.gi` æ–‡ä»¶
   - æ·»åŠ  Metamod åˆ° SearchPaths ç¡®ä¿åŠ è½½

4. **ä¾èµ–å…³ç³»**: 
   - CounterStrikeSharp ä¾èµ– Metamod
   - å®‰è£… CSS å‰ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£… Metamod

**å®‰è£…çŠ¶æ€æ£€æŸ¥** (2025-10-28æ›´æ–°):

Metamod éœ€è¦æ£€æŸ¥å¤šä¸ªå…³é”®æ–‡ä»¶ï¼š
- Windows å¹³å°ï¼šéœ€è¦åŒæ—¶å­˜åœ¨ `bin/metamod.2.bgt.dll` å’Œ `bin/win64/server.dll`
- Linux å¹³å°ï¼šéœ€è¦å­˜åœ¨ `bin/linuxsteamrt64/metamod.so`

```csharp
// Windows å®‰è£…æ£€æŸ¥
var metamodBgtDll = Path.Combine(metaModPath, "bin", "metamod.2.bgt.dll");
var serverDll = Path.Combine(metaModPath, "bin", "win64", "server.dll");
var windowsInstalled = File.Exists(metamodBgtDll) && File.Exists(serverDll);
```

**å®‰è£…æµç¨‹è¿›åº¦**:

| é˜¶æ®µ | è¿›åº¦ | è¯´æ˜ |
|------|------|------|
| å‡†å¤‡ | 0-10% | è·å–ç‰ˆæœ¬ä¿¡æ¯ |
| ä¸‹è½½ | 10-50% | ä¸‹è½½æ¡†æ¶æ–‡ä»¶ |
| è§£å‹ | 50-90% | è§£å‹åˆ°ç›®æ ‡ç›®å½• |
| é…ç½® | 90-95% | é…ç½®æ–‡ä»¶å¤„ç† |
| å®Œæˆ | 95-100% | æ¸…ç†ä¸´æ—¶æ–‡ä»¶ |

**é”™è¯¯å¤„ç†**:

- ç½‘ç»œé”™è¯¯ï¼šè¿”å›å‹å¥½é”™è¯¯ä¿¡æ¯ï¼Œå»ºè®®æ£€æŸ¥ç½‘ç»œè¿æ¥
- è§£å‹å¤±è´¥ï¼šè‡ªåŠ¨æ¢å¤å¤‡ä»½
- é…ç½®å¤±è´¥ï¼šæç¤ºç”¨æˆ·æ‰‹åŠ¨é…ç½®ï¼ˆä¸å½±å“æ¡†æ¶æœ¬èº«ï¼‰

---

## 6. Provideræ‰©å±•æœºåˆ¶

### 6.1 è®¾è®¡æ€æƒ³

ä½¿ç”¨**ç­–ç•¥æ¨¡å¼ + æä¾›è€…æ¨¡å¼**ï¼Œå°†ä¸åŒå¹³å°ã€ä¸åŒæ¡†æ¶çš„å®ç°è§£è€¦ã€‚

**æ ¸å¿ƒæ¥å£**:
- `IPlatformProvider`: æŠ½è±¡æ“ä½œç³»ç»Ÿå·®å¼‚ï¼ˆWindowsã€Linuxï¼‰
- `IFrameworkProvider`: æŠ½è±¡æ’ä»¶æ¡†æ¶å·®å¼‚ï¼ˆCSSã€Metamodã€Swiftlyï¼‰
- `IExtensionProvider`: æŠ½è±¡é¢æ¿æ‰©å±•åŠŸèƒ½ï¼ˆRCONã€å¤‡ä»½ã€ç›‘æ§ï¼‰

### 6.2 Providerç”Ÿå‘½å‘¨æœŸ

```
1. å¯åŠ¨é˜¶æ®µï¼š
   - æ‰«æproviders/ç›®å½•
   - åŠ è½½æ‰€æœ‰Provider DLL
   - æ³¨å†Œåˆ°ProviderRegistry

2. ä½¿ç”¨é˜¶æ®µï¼š
   - æ ¹æ®éœ€æ±‚è·å–å¯¹åº”Provider
   - è°ƒç”¨Provideræ–¹æ³•æ‰§è¡Œæ“ä½œ

3. æ‰©å±•é˜¶æ®µï¼š
   - ç”¨æˆ·ä¸‹è½½ç¬¬ä¸‰æ–¹Provider
   - æ”¾å…¥providers/ç›®å½•
   - é‡å¯åº”ç”¨è‡ªåŠ¨åŠ è½½
```

### 6.3 Providerå¼€å‘æŒ‡å—

ç¤¾åŒºå¼€å‘è€…åªéœ€ï¼š
1. å¼•ç”¨`CSP2.Core`ï¼ˆæ¥å£å®šä¹‰ï¼‰
2. å®ç°å¯¹åº”æ¥å£
3. æ·»åŠ å…ƒæ•°æ®ç‰¹æ€§
4. ç¼–è¯‘æˆDLL
5. åˆ†äº«ç»™ç”¨æˆ·

**ç¤ºä¾‹**:
```csharp
// ç¤¾åŒºå¼€å‘è€…å®ç°Linuxæ”¯æŒ
public class LinuxPlatformProvider : IPlatformProvider
{
    public ProviderMetadata Metadata => new()
    {
        Id = "linux",
        Name = "Linux",
        Version = "1.0.0",
        Author = "Community Developer",
        Description = "Linuxå¹³å°æ”¯æŒ"
    };
    
    public bool IsSupported()
    {
        return RuntimeInformation.IsOSPlatform(OSPlatform.Linux);
    }
    
    // ... å®ç°å…¶ä»–æ–¹æ³•
}
```

---

## 7. å®‰å…¨æ€§è€ƒè™‘

### 7.1 æ½œåœ¨é£é™©

1. **ä»»æ„ä»£ç æ‰§è¡Œ**: è¿è¡Œæ—¶åŠ è½½ç¬¬ä¸‰æ–¹Provider DLL
2. **è·¯å¾„éå†**: ç”¨æˆ·è¾“å…¥çš„å®‰è£…è·¯å¾„
3. **å‘½ä»¤æ³¨å…¥**: æ„é€ æœåŠ¡å™¨å¯åŠ¨å‚æ•°
4. **æ•æ„Ÿä¿¡æ¯æ³„éœ²**: Steam Tokenç­‰

### 7.2 ç¼“è§£æªæ–½

1. **Providerç­¾åéªŒè¯**ï¼ˆV2ï¼‰: åªåŠ è½½ç­¾åçš„DLL
2. **è·¯å¾„éªŒè¯**: æ£€æŸ¥è·¯å¾„æ˜¯å¦åŒ…å«å±é™©å­—ç¬¦
3. **å‚æ•°è½¬ä¹‰**: ä½¿ç”¨`ProcessStartInfo`çš„å‚æ•°æ•°ç»„è€Œéå­—ç¬¦ä¸²
4. **é…ç½®åŠ å¯†**: æ•æ„Ÿé…ç½®ä½¿ç”¨DPAPIåŠ å¯†å­˜å‚¨
5. **æƒé™æœ€å°åŒ–**: ä¸è¦æ±‚ç®¡ç†å‘˜æƒé™

---

## 8. æ€§èƒ½ä¼˜åŒ–

### 8.1 å¼‚æ­¥æ“ä½œ

æ‰€æœ‰è€—æ—¶æ“ä½œä½¿ç”¨`async/await`:
- æ–‡ä»¶ä¸‹è½½
- è¿›ç¨‹å¯åŠ¨/åœæ­¢
- æ—¥å¿—è¯»å–
- ç½‘ç»œè¯·æ±‚

### 8.2 ç¼“å­˜ç­–ç•¥

- **æ’ä»¶åˆ—è¡¨**: æœ¬åœ°ç¼“å­˜1å°æ—¶ï¼Œè¿‡æœŸåé‡æ–°æ‹‰å–
- **æ¡†æ¶ç‰ˆæœ¬**: ç¼“å­˜æœ€æ–°ç‰ˆæœ¬ä¿¡æ¯
- **æœåŠ¡å™¨é…ç½®**: å†…å­˜ç¼“å­˜ï¼Œå˜æ›´æ—¶æŒä¹…åŒ–

### 8.3 UIå“åº”æ€§

- é•¿æ—¶é—´æ“ä½œæ˜¾ç¤ºè¿›åº¦æ¡
- ä½¿ç”¨`IProgress<T>`æŠ¥å‘Šè¿›åº¦
- æ—¥å¿—æ˜¾ç¤ºä½¿ç”¨è™šæ‹ŸåŒ–åˆ—è¡¨ï¼ˆè¶…è¿‡1000è¡Œæ—¶ï¼‰
- ä½¿ç”¨`Dispatcher`/`SynchronizationContext`æ›´æ–°UI

### 8.4 UIçº¿ç¨‹ç®¡ç†ï¼ˆé‡è¦ï¼‰

**å·²çŸ¥é—®é¢˜ä¿®å¤ - UIå¡æ­»é—®é¢˜**:

åœ¨WPFåº”ç”¨ä¸­ï¼Œæ‰€æœ‰UIæ›´æ–°å¿…é¡»åœ¨UIçº¿ç¨‹æ‰§è¡Œï¼Œä½†é•¿æ—¶é—´æ“ä½œä¼šå¯¼è‡´ç•Œé¢å¡æ­»ã€‚ä»¥ä¸‹æ˜¯å…³é”®æœ€ä½³å®è·µï¼š

1. **åŒæ­¥é˜»å¡æ“ä½œå¿…é¡»å¼‚æ­¥åŒ–**
   ```csharp
   // âŒ é”™è¯¯: åŒæ­¥æ“ä½œé˜»å¡UIçº¿ç¨‹
   ZipFile.ExtractToDirectory(zipPath, installPath);
   
   // âœ… æ­£ç¡®: åœ¨åå°çº¿ç¨‹æ‰§è¡Œ
   await Task.Run(() => ZipFile.ExtractToDirectory(zipPath, installPath));
   ```

2. **Progresså›è°ƒä½¿ç”¨BeginInvokeè€Œä¸æ˜¯Invoke**
   ```csharp
   // âŒ é”™è¯¯: Invokeä¼šé˜»å¡åå°çº¿ç¨‹
   Dispatcher.Invoke(() => { Progress = value; });
   
   // âœ… æ­£ç¡®: BeginInvokeæ˜¯å¼‚æ­¥çš„
   Dispatcher.BeginInvoke(() => { Progress = value; });
   ```

3. **MessageBoxåœ¨å¼‚æ­¥æ–¹æ³•ä¸­çš„æ­£ç¡®ä½¿ç”¨**
   ```csharp
   // âœ… æ­£ç¡®: é€šè¿‡Dispatcherå¼‚æ­¥è°ƒç”¨
   var result = await Dispatcher.InvokeAsync(() => 
       MessageBox.Show("æç¤º", "æ ‡é¢˜", MessageBoxButton.YesNo));
   ```

4. **é¿å…åœ¨åŒæ­¥æ–¹æ³•ä¸­ç­‰å¾…å¼‚æ­¥æ“ä½œ**
   ```csharp
   // âŒ é”™è¯¯: å®¹æ˜“å¯¼è‡´æ­»é”
   var result = asyncMethod().GetAwaiter().GetResult();
   
   // âœ… æ­£ç¡®: åœ¨æ–°ä»»åŠ¡ä¸Šä¸‹æ–‡æ‰§è¡Œ
   var task = Task.Run(async () => await asyncMethod());
   var result = task.GetAwaiter().GetResult();
   ```

### 8.5 å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æŠ¥å‘Šç³»ç»Ÿ

**æ”¹è¿›çš„é”™è¯¯å¤„ç†æœºåˆ¶**ï¼ˆ2025-10-26æ›´æ–°ï¼‰:

CSP2å®ç°äº†å®Œå–„çš„ä¸‰å±‚å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒå’Œé”™è¯¯è¯Šæ–­ï¼š

1. **å…¨å±€å¼‚å¸¸æ•è·**
   - `AppDomain.UnhandledException`: æ•è·åº”ç”¨ç¨‹åºåŸŸçº§åˆ«çš„æœªå¤„ç†å¼‚å¸¸
   - `DispatcherUnhandledException`: æ•è·UIçº¿ç¨‹çš„æœªå¤„ç†å¼‚å¸¸
   - `TaskScheduler.UnobservedTaskException`: æ•è·å¼‚æ­¥ä»»åŠ¡ä¸­æœªè§‚å¯Ÿåˆ°çš„å¼‚å¸¸

2. **ErrorDialog - å‹å¥½çš„é”™è¯¯å¯¹è¯æ¡†**
   ```csharp
   // ä½¿ç”¨æ–¹æ³•
   ErrorDialog.Show(
       errorMessage: "ç®€çŸ­çš„é”™è¯¯æè¿°",
       exception: ex,
       subtitle: "æ“ä½œå·²åœæ­¢"
   );
   ```
   
   **ç‰¹æ€§**ï¼š
   - æ˜¾ç¤ºç®€çŸ­é”™è¯¯æ¶ˆæ¯å’Œè¯¦ç»†å †æ ˆä¿¡æ¯
   - æ”¯æŒæ–‡æœ¬é€‰æ‹©å’Œå¤åˆ¶ï¼ˆCtrl+Cï¼‰
   - "å¤åˆ¶å…¨éƒ¨"æŒ‰é’®ä¸€é”®å¤åˆ¶å®Œæ•´é”™è¯¯æŠ¥å‘Š
   - åŒ…å«ç¯å¢ƒä¿¡æ¯ï¼ˆæ“ä½œç³»ç»Ÿã€.NETç‰ˆæœ¬ç­‰ï¼‰
   - **ä¸ä¼šç«‹å³é€€å‡ºç¨‹åº**ï¼Œå…è®¸ç”¨æˆ·å¤åˆ¶é”™è¯¯ä¿¡æ¯åå†³å®šæ“ä½œ

3. **å¼‚å¸¸å¤„ç†ç­–ç•¥**
   - **UIçº¿ç¨‹å¼‚å¸¸**: æ˜¾ç¤ºErrorDialogï¼Œæ ‡è®°`e.Handled = true`ï¼Œç¨‹åºç»§ç»­è¿è¡Œ
   - **åå°ä»»åŠ¡å¼‚å¸¸**: è°ƒç”¨`e.SetObserved()`ï¼Œæ˜¾ç¤ºErrorDialog
   - **åŸŸçº§å¼‚å¸¸**: æ˜¾ç¤ºErrorDialogåè®°å½•æ—¥å¿—
   - æ‰€æœ‰å¼‚å¸¸éƒ½ä¼šåŒæ—¶è®°å½•åˆ°Serilogæ—¥å¿—ç³»ç»Ÿå’ŒDebugLogger

4. **é”™è¯¯åœæ­¢æœºåˆ¶**
   - å¼‚å¸¸å‘ç”Ÿæ—¶ç«‹å³åœæ­¢å½“å‰æ“ä½œï¼ˆè®¾ç½®Handled/SetObservedï¼‰
   - é˜²æ­¢è¿é”é”™è¯¯ï¼ˆå¦‚XAMLè§£æé”™è¯¯ä¸ä¼šç–¯ç‹‚é‡å¤ï¼‰
   - ä¿æŒåº”ç”¨ç¨‹åºç¨³å®šï¼Œç»™ç”¨æˆ·é€‰æ‹©æƒ

**ç¤ºä¾‹ï¼šå¤„ç†ä¸‹è½½é”™è¯¯**
```csharp
try
{
    await _downloadManager.DownloadAsync(url, path, progress);
}
catch (Exception ex)
{
    Log.Error(ex, "ä¸‹è½½å¤±è´¥");
    DebugLogger.Error("Download", "ä¸‹è½½æ–‡ä»¶å¤±è´¥", ex);
    
    // æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯å¯¹è¯æ¡†
    ErrorDialog.Show(
        errorMessage: $"ä¸‹è½½å¤±è´¥ï¼š{ex.Message}",
        exception: ex,
        subtitle: "ä¸‹è½½æ“ä½œå·²åœæ­¢"
    );
    
    // æ¸…ç†éƒ¨åˆ†ä¸‹è½½çš„æ–‡ä»¶
    CleanupPartialDownload(path);
}
```

---

## 9. è°ƒè¯•å’Œæ—¥å¿—ç³»ç»Ÿ

### 9.1 Debugæ¨¡å¼

CSP2æ”¯æŒDebugæ¨¡å¼ï¼Œæä¾›æ›´è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼š

**å¯ç”¨æ–¹å¼**:
1. **å‘½ä»¤è¡Œå‚æ•°**: `CSP2.Desktop.exe --debug`
2. **ç¯å¢ƒå˜é‡**: è®¾ç½® `CSP2_DEBUG=true`
3. **VS Code**: ä½¿ç”¨ "CSP2 Desktop (Debug Mode)" å¯åŠ¨é…ç½®

**Debugæ¨¡å¼ç‰¹æ€§**:
- è‡ªåŠ¨å¯ç”¨Debugçº§åˆ«æ—¥å¿—è®°å½•
- ä¾§æ æ˜¾ç¤º"Debugæ§åˆ¶å°"èœå•é¡¹
- å®æ—¶æŸ¥çœ‹åº”ç”¨ç¨‹åºçº§åˆ«çš„è°ƒè¯•æ—¥å¿—
- ç‹¬ç«‹äºæœåŠ¡å™¨æ—¥å¿—çš„åº”ç”¨æ—¥å¿—ç³»ç»Ÿ

### 9.2 åŒæ—¥å¿—ç³»ç»Ÿæ¶æ„

CSP2ä½¿ç”¨åŒæ—¥å¿—ç³»ç»Ÿï¼š

1. **åº”ç”¨æ—¥å¿— (DebugLogger)** - Debugæ§åˆ¶å°
   - æ˜¾ç¤ºåº”ç”¨ç¨‹åºæœ¬èº«çš„æ“ä½œæ—¥å¿—
   - åŒ…æ‹¬ï¼šç”¨æˆ·æ“ä½œã€æœåŠ¡è°ƒç”¨ã€çŠ¶æ€å˜åŒ–ã€é”™è¯¯å¼‚å¸¸
   - æ”¯æŒè¿‡æ»¤ï¼šDebug/Info/Warning/Error
   - æ”¯æŒå¯¼å‡ºåˆ°æ–‡ä»¶
   - **å†å²æ—¥å¿—ç¼“å†²**: è‡ªåŠ¨ä¿å­˜æœ€è¿‘5000æ¡æ—¥å¿—ï¼Œæ‰“å¼€Debugæ§åˆ¶å°æ—¶è‡ªåŠ¨åŠ è½½å†å²è®°å½•

2. **æœåŠ¡å™¨æ—¥å¿— (LogConsole)** - æ—¥å¿—æ§åˆ¶å°  
   - æ˜¾ç¤ºCS2æœåŠ¡å™¨è¿›ç¨‹çš„è¾“å‡º
   - å®æ—¶æ•è·æœåŠ¡å™¨stdout/stderr
   - æ”¯æŒå‘é€å‘½ä»¤åˆ°æœåŠ¡å™¨

### 9.3 DebugLoggerä½¿ç”¨ç¤ºä¾‹

```csharp
// åœ¨ä»»ä½•åœ°æ–¹è®°å½•è°ƒè¯•æ—¥å¿—
DebugLogger.Debug("Category", "è¯¦ç»†è°ƒè¯•ä¿¡æ¯");
DebugLogger.Info("Category", "é‡è¦ä¿¡æ¯");
DebugLogger.Warning("Category", "è­¦å‘Šä¿¡æ¯");
DebugLogger.Error("Category", "é”™è¯¯ä¿¡æ¯", exception);

// æ£€æŸ¥æ˜¯å¦ä¸ºDebugæ¨¡å¼
if (DebugLogger.IsDebugMode)
{
    // åªåœ¨Debugæ¨¡å¼ä¸‹æ‰§è¡Œçš„ä»£ç 
}

// è·å–å†å²æ—¥å¿—ï¼ˆé€šå¸¸åœ¨åˆå§‹åŒ–UIç»„ä»¶æ—¶ä½¿ç”¨ï¼‰
var history = DebugLogger.GetHistory();
foreach (var logEvent in history)
{
    // å¤„ç†å†å²æ—¥å¿—
}
```

### 9.4 è¯Šæ–­æ—¥å¿—å¢å¼º

**æ’ä»¶å¸‚åœºæ—¥å¿—**ï¼ˆv0.1.1æ–°å¢ï¼‰ï¼š

ä¸ºå¸®åŠ©è¯Šæ–­"æ’ä»¶å¸‚åœºæ‰¾ä¸åˆ°æ’ä»¶"ç­‰é—®é¢˜ï¼Œåœ¨å…³é”®ä½ç½®å¢åŠ äº†è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼š

1. **PluginRepositoryService**:
   - ä»“åº“æºåˆ—è¡¨æ„å»ºè¿‡ç¨‹
   - æ¯ä¸ªè¿œç¨‹æºçš„è¯·æ±‚çŠ¶æ€ï¼ˆHTTPçŠ¶æ€ç ï¼‰
   - å“åº”å†…å®¹é•¿åº¦å’Œé¢„è§ˆ
   - JSONè§£æç»“æœ
   - ç¼“å­˜æ“ä½œè¯¦æƒ…

2. **PluginMarketViewModel**:
   - æ¸…å•è·å–è¿”å›çš„æ’ä»¶æ•°é‡
   - æ¯ä¸ªæ’ä»¶çš„æ·»åŠ è¿‡ç¨‹
   - è¿‡æ»¤å‰åçš„æ’ä»¶æ•°é‡å˜åŒ–
   - æœ€ç»ˆæ˜¾ç¤ºçš„æ’ä»¶åˆ—è¡¨

**æ—¥å¿—ç¤ºä¾‹**ï¼š
```
[INFO] PluginRepositoryService: å‡†å¤‡å°è¯• 3 ä¸ªä»“åº“æº
[INFO] PluginRepositoryService: å°è¯•æº [1/3]: https://cdn.jsdelivr.net/...
[DEBUG] PluginRepositoryService: HTTP å“åº”: 200 OK
[DEBUG] PluginRepositoryService: å“åº”å†…å®¹: 12543 å­—ç¬¦
[INFO] PluginRepositoryService: âœ“ æˆåŠŸè·å– 15 ä¸ªæ’ä»¶ (æº 1/3)
[INFO] LoadDataAsync: æ’ä»¶åŠ è½½å®Œæˆï¼ŒPlugins.Count = 15
[INFO] ApplyFilter: è¿‡æ»¤å®Œæˆï¼Œæ˜¾ç¤º 15 ä¸ªæ’ä»¶
```

### 9.5 æ—¥å¿—çº§åˆ«ç­–ç•¥

| æ¨¡å¼ | Serilogçº§åˆ« | DebugLogger | ç”¨é€” |
|------|------------|-------------|------|
| Release | Information | ä»…InfoåŠä»¥ä¸Š | ç”Ÿäº§ç¯å¢ƒ |
| Debug | Debug | å…¨éƒ¨çº§åˆ« | å¼€å‘è°ƒè¯• |

### 9.6 æ—¥å¿—æ–‡ä»¶ä½ç½®

- **æ–‡ä»¶è·¯å¾„**: `<åº”ç”¨ç›®å½•>/logs/csp2-YYYY-MM-DD.log`
- **æ»šåŠ¨ç­–ç•¥**: æ¯å¤©ä¸€ä¸ªæ–°æ–‡ä»¶
- **ä¿ç•™ç­–ç•¥**: ä¿ç•™30å¤©
- **å¤§å°é™åˆ¶**: å•æ–‡ä»¶æœ€å¤§10MB

### 9.7 VS Codeè°ƒè¯•é…ç½®

é¡¹ç›®åŒ…å« `.vscode/launch.json` å’Œ `.vscode/tasks.json`:

```json
{
  "name": "CSP2 Desktop (Debug Mode)",
  "type": "coreclr",
  "request": "launch",
  "args": ["--debug"],
  "env": { "CSP2_DEBUG": "true" }
}
```

**ä½¿ç”¨æ­¥éª¤**:
1. åœ¨VS Codeä¸­æ‰“å¼€é¡¹ç›®
2. æŒ‰ F5 æˆ–é€‰æ‹©"è¿è¡Œå’Œè°ƒè¯•"
3. é€‰æ‹© "CSP2 Desktop (Debug Mode)"
4. åº”ç”¨å°†ä»¥Debugæ¨¡å¼å¯åŠ¨ï¼Œä¾§æ æ˜¾ç¤ºDebugæ§åˆ¶å°

---

## 10. ç»Ÿä¸€ä¸‹è½½ç®¡ç†ç³»ç»Ÿ

**æ›´æ–°æ—¶é—´**: 2025-10-25

CSP2å®ç°äº†ç»Ÿä¸€çš„ä¸‹è½½ç®¡ç†ç³»ç»Ÿï¼Œæ‰€æœ‰ä¸‹è½½ä»»åŠ¡ï¼ˆæœåŠ¡å™¨æ–‡ä»¶ã€æ’ä»¶ã€æ¡†æ¶ã€æ›´æ–°ç­‰ï¼‰éƒ½é€šè¿‡å…¨å±€ä¸‹è½½ç®¡ç†å™¨è¿›è¡Œç®¡ç†ã€‚

### 10.1 ä¸‹è½½ç®¡ç†æ¶æ„

```
ç”¨æˆ·æ“ä½œ (å®‰è£…æœåŠ¡å™¨/æ’ä»¶)
    â†“
åˆ›å»ºæœåŠ¡å™¨/æ’ä»¶é…ç½®
    â†“
æ·»åŠ åˆ°DownloadManager (åå°ä»»åŠ¡)
    â†“
ç«‹å³è¿”å›ä¸»é¡µé¢ (éé˜»å¡)
    â†“
åå°ä¸‹è½½è¿›è¡Œä¸­
    â†“
ç”¨æˆ·å¯åœ¨ä¸‹è½½ç®¡ç†é¡µé¢æŸ¥çœ‹è¿›åº¦
```

### 10.2 æ ¸å¿ƒç‰¹æ€§

1. **éé˜»å¡æ“ä½œ**
   - ç”¨æˆ·ç‚¹å‡»"å®‰è£…æœåŠ¡å™¨"åï¼Œç«‹å³è¿”å›æœåŠ¡å™¨åˆ—è¡¨
   - æœåŠ¡å™¨é…ç½®å·²åˆ›å»ºï¼Œæ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­
   - ä¸‹è½½ä»»åŠ¡åœ¨åå°é™é»˜è¿›è¡Œ

2. **ç»Ÿä¸€å…¥å£**
   - ä¾§è¾¹æ å¯¼èˆªï¼šä¸‹è½½ç®¡ç†é¡µé¢ï¼ˆå…¨å±æŸ¥çœ‹ï¼‰
   - ä¸‹è½½æ‚¬æµ®çƒï¼šåœ¨ä»»ä½•é¡µé¢æ˜¾ç¤ºï¼Œç‚¹å‡»è·³è½¬åˆ°ä¸‹è½½ç®¡ç†
   - å®æ—¶å¾½ç« ï¼šæ˜¾ç¤ºå½“å‰æ´»åŠ¨ä¸‹è½½æ•°é‡

3. **å¤šä»»åŠ¡å¹¶è¡Œ**
   - æ”¯æŒåŒæ—¶ä¸‹è½½å¤šä¸ªä»»åŠ¡
   - æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹è¿›åº¦è¿½è¸ª
   - æ”¯æŒæš‚åœã€å–æ¶ˆã€ç§»é™¤æ“ä½œ

### 10.3 ä¸‹è½½ç®¡ç†é¡µé¢åŠŸèƒ½

**ä½ç½®**: ä¸»çª—å£ â†’ ä¸‹è½½ç®¡ç†ï¼ˆä¾§è¾¹æ ï¼‰

**æ˜¾ç¤ºå†…å®¹**:
- ä»»åŠ¡åç§°å’Œæè¿°
- å®æ—¶è¿›åº¦æ¡ï¼ˆç™¾åˆ†æ¯”ï¼‰
- ä»»åŠ¡çŠ¶æ€ï¼ˆç­‰å¾…/ä¸‹è½½ä¸­/å®Œæˆ/å¤±è´¥/å·²å–æ¶ˆï¼‰
- åˆ›å»ºæ—¶é—´
- æ“ä½œæŒ‰é’®ï¼ˆå–æ¶ˆã€ç§»é™¤ï¼‰

**çŠ¶æ€è¯´æ˜**:
- **ç­‰å¾…ä¸­** (â³): ä»»åŠ¡å·²åˆ›å»ºï¼Œç­‰å¾…å¼€å§‹
- **ä¸‹è½½ä¸­** (â¬‡ï¸): æ­£åœ¨ä¸‹è½½ï¼Œæ˜¾ç¤ºå®æ—¶è¿›åº¦
- **å®Œæˆ** (âœ…): ä¸‹è½½æˆåŠŸå®Œæˆ
- **å¤±è´¥** (âŒ): ä¸‹è½½å‡ºé”™ï¼Œå¯æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
- **æš‚åœ** (â¸ï¸): ä»»åŠ¡å·²æš‚åœï¼ˆæœªæ¥æ”¯æŒï¼‰
- **å·²å–æ¶ˆ** (ğŸš«): ç”¨æˆ·å–æ¶ˆä¸‹è½½

### 10.4 ä¸‹è½½æ‚¬æµ®çƒ

**ä½ç½®**: ä¸»çª—å£å³ä¸‹è§’ï¼ˆçŠ¶æ€æ ä¸Šæ–¹ï¼‰

**æ˜¾ç¤ºé€»è¾‘**:
- æœ‰æ´»åŠ¨ä¸‹è½½æ—¶è‡ªåŠ¨æ˜¾ç¤º
- æ— ä¸‹è½½ä»»åŠ¡æ—¶è‡ªåŠ¨éšè—

**æ˜¾ç¤ºå†…å®¹**:
- ä¸‹è½½å›¾æ ‡ (â¬‡ï¸)
- æ´»åŠ¨ä¸‹è½½ä»»åŠ¡æ•°é‡å¾½ç« 
- å‘å…‰åŠ¨æ•ˆæç¤º

**äº¤äº’**:
- ç‚¹å‡»ï¼šå¯¼èˆªåˆ°ä¸‹è½½ç®¡ç†é¡µé¢
- æ‚¬åœï¼šæ”¾å¤§æ•ˆæœ

### 10.5 æœåŠ¡å™¨å®‰è£…æµç¨‹æ”¹è¿›

**æ—§æµç¨‹**ï¼ˆé˜»å¡ï¼‰:
```
æ­¥éª¤1: é€‰æ‹©æ–¹å¼ â†’ æ­¥éª¤2: å¡«å†™ä¿¡æ¯ â†’ æ­¥éª¤3: ç­‰å¾…ä¸‹è½½å®Œæˆ â†’ è¿”å›ä¸»é¡µ
                                        â†‘ ç”¨æˆ·è¢«å¡åœ¨è¿™é‡Œ
```

**æ–°æµç¨‹**ï¼ˆéé˜»å¡ï¼‰:
```
æ­¥éª¤1: é€‰æ‹©æ–¹å¼ â†’ æ­¥éª¤2: å¡«å†™ä¿¡æ¯ â†’ ç«‹å³è¿”å›ä¸»é¡µ âœ“
                                  â†“
                            åå°ä¸‹è½½ï¼ˆå¼‚æ­¥ï¼‰
                                  â†“
                         ä¸‹è½½ç®¡ç†é¡µé¢æ˜¾ç¤ºè¿›åº¦
```

**ä¼˜åŠ¿**:
- âœ… ç”¨æˆ·ä½“éªŒæµç•…ï¼Œæ— éœ€ç­‰å¾…
- âœ… å¯ä»¥ç»§ç»­å…¶ä»–æ“ä½œï¼ˆæŸ¥çœ‹æ—¥å¿—ã€ç®¡ç†æ’ä»¶ç­‰ï¼‰
- âœ… æ”¯æŒæ‰¹é‡å®‰è£…ï¼ˆå¤šä¸ªæœåŠ¡å™¨åŒæ—¶ä¸‹è½½ï¼‰
- âœ… ç»Ÿä¸€çš„è¿›åº¦ç›‘æ§ç•Œé¢

### 10.6 å®ç°ç»†èŠ‚

**åå°ä»»åŠ¡ç®¡ç†**:
```csharp
// æœåŠ¡å™¨å®‰è£…æµç¨‹
var server = await _serverManager.AddServerWithoutValidationAsync(name, path, config);
_onInstallComplete?.Invoke(server); // ç«‹å³è¿”å›ä¸»é¡µ

// åå°ä¸‹è½½ä»»åŠ¡
_ = Task.Run(async () =>
{
    await _steamCmdService.InstallOrUpdateServerAsync(path, false, null);
    // DownloadManagerä¼šè‡ªåŠ¨ç®¡ç†ä»»åŠ¡çŠ¶æ€
});
```

**äº‹ä»¶åŒæ­¥**:
- `DownloadManager.TaskAdded`: æ–°ä»»åŠ¡æ·»åŠ æ—¶æ›´æ–°UI
- `DownloadManager.TaskUpdated`: è¿›åº¦æ›´æ–°æ—¶åˆ·æ–°UI
- `DownloadManager.TaskCompleted`: ä»»åŠ¡å®Œæˆæ—¶é€šçŸ¥ç”¨æˆ·
- `DownloadManager.TaskFailed`: ä»»åŠ¡å¤±è´¥æ—¶æ˜¾ç¤ºé”™è¯¯

**SteamCMD è¿›åº¦è§£æ** (2025-10-25æ›´æ–°):

æ ¹æ® [SteamCMD å®˜æ–¹æ–‡æ¡£](https://developer.valvesoftware.com/wiki/Zh/SteamCMD)ï¼ŒSteamCMD è¾“å‡ºä»¥ä¸‹æ ¼å¼çš„è¿›åº¦ä¿¡æ¯ï¼š

```
Update state (0x61) downloading, progress: 12.34 (1234567890 / 10000000000)
Update state (0x81) verifying, progress: 56.78 (...)
Success! App '730' fully installed.
```

CSP2 å®ç°äº†ç²¾ç¡®çš„è¿›åº¦è§£æï¼š

1. **ç²¾ç¡®è¿›åº¦æå–**: ä» `progress: X.XX` ä¸­æå–ç™¾åˆ†æ¯”
2. **çŠ¶æ€è¯†åˆ«**: 
   - `downloading` â†’ æ­£åœ¨ä¸‹è½½ CS2 æœåŠ¡å™¨æ–‡ä»¶
   - `verifying` â†’ æ­£åœ¨éªŒè¯æ–‡ä»¶å®Œæ•´æ€§
   - `preallocating` â†’ æ­£åœ¨é¢„åˆ†é…ç£ç›˜ç©ºé—´
   - `validating` â†’ æ­£åœ¨éªŒè¯ç°æœ‰æ–‡ä»¶
3. **è¿›åº¦æ˜ å°„**: å°†0-100%æ˜ å°„åˆ°30-100%ï¼ˆå‰30%ä¸ºSteamCMDå®‰è£…ï¼‰
4. **èŠ‚æµä¼˜åŒ–**: é™åˆ¶æ›´æ–°é¢‘ç‡ä¸º500msï¼Œé¿å…UIåˆ·æ–°è¿‡å¿«
5. **å¤‡ç”¨èŠ‚ç‚¹**: è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸­å›½å†…åœ°èŠ‚ç‚¹ï¼ˆ`media.st.dl.bscstorage.net`ï¼‰

**ç¤ºä¾‹è¾“å‡ºè§£æ**:
```csharp
// è¾“å…¥: "Update state (0x61) downloading, progress: 45.67 (12345678 / 27890123)"
// è§£æ: è¿›åº¦ = 45.67%
// æ˜ å°„: 30 + (45.67 * 0.7) = 61.97%
// æ¶ˆæ¯: "æ­£åœ¨ä¸‹è½½ CS2 æœåŠ¡å™¨æ–‡ä»¶... 45.67%"
```

### 10.7 ç”¨æˆ·ä½¿ç”¨æŒ‡å—

**å®‰è£…æœåŠ¡å™¨**:
1. ç‚¹å‡»"å®‰è£…æœåŠ¡å™¨"
2. é€‰æ‹©ä¸‹è½½æ–¹å¼ï¼ˆSteamCMDæˆ–ç°æœ‰å®‰è£…ï¼‰
3. å¡«å†™æœåŠ¡å™¨åç§°å’Œé…ç½®
4. ç‚¹å‡»"ç¡®è®¤æ·»åŠ "
5. ç«‹å³è¿”å›æœåŠ¡å™¨åˆ—è¡¨ï¼ˆæœåŠ¡å™¨å·²æ·»åŠ ï¼‰
6. ç‚¹å‡»æ‚¬æµ®çƒæˆ–ä¾§è¾¹æ "ä¸‹è½½ç®¡ç†"æŸ¥çœ‹ä¸‹è½½è¿›åº¦
7. ä¸‹è½½å®Œæˆåï¼ŒæœåŠ¡å™¨å³å¯å¯åŠ¨

**ç›‘æ§ä¸‹è½½è¿›åº¦**:
- æ–¹å¼1: ç‚¹å‡»å³ä¸‹è§’æ‚¬æµ®çƒï¼ˆæœ‰ä¸‹è½½æ—¶æ˜¾ç¤ºï¼‰
- æ–¹å¼2: ä¾§è¾¹æ  â†’ ä¸‹è½½ç®¡ç†
- æ–¹å¼3: æ‚¬æµ®çƒå¾½ç« æ˜¾ç¤ºæ´»åŠ¨ä»»åŠ¡æ•°é‡

**ç®¡ç†ä¸‹è½½ä»»åŠ¡**:
- æŸ¥çœ‹æ‰€æœ‰ä¸‹è½½ä»»åŠ¡ï¼ˆæ´»åŠ¨å’Œå†å²ï¼‰
- å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä¸‹è½½
- ç§»é™¤å·²å®Œæˆæˆ–å¤±è´¥çš„ä»»åŠ¡
- ä¸€é”®æ¸…ç©ºæ‰€æœ‰å·²å®Œæˆä»»åŠ¡

---

## 11. å›½é™…åŒ– (i18n) æ”¯æŒ

**æ›´æ–°æ—¶é—´**: 2025-10-25

CSP2 ç°å·²å…¨é¢æ”¯æŒå›½é™…åŒ–ï¼Œå½“å‰æ”¯æŒç®€ä½“ä¸­æ–‡å’Œè‹±æ–‡ä¸¤ç§è¯­è¨€ã€‚

### 11.1 æ¶æ„è®¾è®¡

- **èµ„æºæ–‡ä»¶ç³»ç»Ÿ**: ä½¿ç”¨ .NET çš„ .resx èµ„æºæ–‡ä»¶ç®¡ç†ç¿»è¯‘
- **LocalizationService**: ç®¡ç†è¯­è¨€åˆ‡æ¢å’Œæ–‡åŒ–è®¾ç½®
- **LocalizationHelper**: æä¾› XAML ç»‘å®šæ”¯æŒ
- **åŠ¨æ€åˆ‡æ¢**: ç”¨æˆ·å¯åœ¨è¿è¡Œæ—¶åˆ‡æ¢è¯­è¨€ï¼Œæ— éœ€é‡å¯

### 11.2 ä½¿ç”¨æ–¹æ³•

**åœ¨ C# ä»£ç ä¸­**:
```csharp
using CSP2.Desktop.Resources;

// ç›´æ¥è®¿é—®
string title = Strings.App_Title;

// æ ¼å¼åŒ–å­—ç¬¦ä¸²
string msg = string.Format(Strings.Download_Completed, taskName);
```

**åœ¨ XAML ä¸­**:
```xaml
<Window.Resources>
    <helpers:LocalizationHelper x:Key="Loc"/>
</Window.Resources>

<TextBlock Text="{Binding Source={StaticResource Loc}, Path=App_Title}"/>
```

**åˆ‡æ¢è¯­è¨€**:
ç”¨æˆ·å¯åœ¨"è®¾ç½®"é¡µé¢çš„"å¤–è§‚"éƒ¨åˆ†åˆ‡æ¢è¯­è¨€ã€‚

### 11.3 æ·»åŠ æ–°è¯­è¨€

1. åˆ›å»ºæ–°çš„èµ„æºæ–‡ä»¶ `Strings.[è¯­è¨€ä»£ç ].resx`
2. æ›´æ–° `LocalizationService.GetSupportedLanguages()`
3. ç¿»è¯‘æ‰€æœ‰å­—ç¬¦ä¸²

è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ `05-i18nå›½é™…åŒ–ä½¿ç”¨æŒ‡å—.md`ã€‚

---

## 12. æœåŠ¡å™¨å¯åŠ¨å‚æ•°é…ç½®ç³»ç»Ÿ

**æ›´æ–°æ—¶é—´**: 2025-10-26

CSP2 æä¾›äº†å®Œå–„çš„æœåŠ¡å™¨å¯åŠ¨å‚æ•°é…ç½®ç³»ç»Ÿï¼Œé€šè¿‡å‹å¥½çš„UIç•Œé¢è®©ç”¨æˆ·è½»æ¾é…ç½®å„ç§æœåŠ¡å™¨å¯åŠ¨é€‰é¡¹ã€‚

### 12.1 é…ç½®åˆ†ç±»

æœåŠ¡å™¨é…ç½®æŒ‰åŠŸèƒ½åˆ†ä¸ºä¸‰å¤§ç±»ï¼Œä½¿ç”¨Tabé¡µç­¾ç»„ç»‡ï¼š

#### **Tab 1: åŸºæœ¬é…ç½®**
- **ç½‘ç»œé…ç½®**: IPåœ°å€ã€ç«¯å£
- **æ¸¸æˆé…ç½®**: åˆå§‹åœ°å›¾ã€æœ€å¤§ç©å®¶æ•°ã€Tick Rateã€åœ°å›¾ç»„

#### **Tab 2: æœåŠ¡å™¨èº«ä»½**
- **æ˜¾ç¤ºä¿¡æ¯**: æœåŠ¡å™¨åœ¨æµè§ˆå™¨ä¸­çš„æ˜¾ç¤ºåç§°
- **è®¤è¯ä¿¡æ¯**: Steam Tokenï¼ˆå…¬å¼€æœåŠ¡å™¨å¿…éœ€ï¼‰
- **å®‰å…¨ä¿¡æ¯**: æœåŠ¡å™¨å¯†ç ã€RCONå¯†ç 

#### **Tab 3: é«˜çº§é€‰é¡¹**
- **ç½‘ç»œé€‰é¡¹**: å±€åŸŸç½‘æ¨¡å¼ã€ç¦ç”¨VAC
- **æ€§èƒ½é€‰é¡¹**: è¿›ç¨‹ä¼˜å…ˆçº§ã€æœ€å¤§FPSã€çº¿ç¨‹æ•°ã€ç¦ç”¨HLTVã€å¯ç”¨æ§åˆ¶å°
- **æ¸¸æˆè§„åˆ™**: BOTæ•°é‡ã€BOTéš¾åº¦ã€è¸¢å‡ºé—²ç½®æ—¶é—´ã€å¯ç”¨ä½œå¼Š
- **æ—¥å¿—é€‰é¡¹**: å¯ç”¨æ—¥å¿—ã€æ§åˆ¶å°æ—¥å¿—å†™å…¥æ–‡ä»¶ã€æ—¥å¿—å›æ˜¾

### 12.2 å¯åŠ¨å‚æ•°è¯´æ˜

| å‚æ•°ç±»åˆ« | å‚æ•°åç§° | è¯´æ˜ | é»˜è®¤å€¼ |
|---------|---------|------|--------|
| **åŸºç¡€é…ç½®** |
| | IPåœ°å€ | æœåŠ¡å™¨ç»‘å®šçš„IPåœ°å€ | 0.0.0.0 (æ‰€æœ‰ç½‘å¡) |
| | ç«¯å£ | æœåŠ¡å™¨ç›‘å¬ç«¯å£ | 27015 |
| | åˆå§‹åœ°å›¾ | æœåŠ¡å™¨å¯åŠ¨æ—¶åŠ è½½çš„åœ°å›¾ | de_dust2 |
| | åœ°å›¾ç»„ | åœ°å›¾è½®æ¢ç»„ | mg_active |
| | æœ€å¤§ç©å®¶æ•° | æœåŠ¡å™¨å…è®¸çš„æœ€å¤§ç©å®¶æ•° | 10 |
| | Tick Rate | æœåŠ¡å™¨åˆ·æ–°ç‡(64/128) | 128 |
| **æœåŠ¡å™¨èº«ä»½** |
| | æœåŠ¡å™¨åç§° | åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºçš„åç§° | (å¯é€‰) |
| | Steam Token | å…¬å¼€æœåŠ¡å™¨ä»¤ç‰Œ | (å¯é€‰) |
| | æœåŠ¡å™¨å¯†ç  | è¿›å…¥æœåŠ¡å™¨çš„å¯†ç  | (å¯é€‰) |
| | RCONå¯†ç  | è¿œç¨‹ç®¡ç†å¯†ç  | (å¯é€‰) |
| **ç½‘ç»œè®¾ç½®** |
| | å±€åŸŸç½‘æ¨¡å¼ | æ˜¯å¦ä¸ºå±€åŸŸç½‘æœåŠ¡å™¨ | å¦ |
| | ç¦ç”¨VAC | ç¦ç”¨åå¤–æŒ‚ç³»ç»Ÿ | å¦ |
| **æ€§èƒ½ä¼˜åŒ–** |
| | è¿›ç¨‹ä¼˜å…ˆçº§ | CPUä¼˜å…ˆçº§(ä½/æ™®é€š/é«˜) | æ™®é€š |
| | æœ€å¤§FPS | æœåŠ¡å™¨æœ€å¤§å¸§ç‡ | (æ— é™åˆ¶) |
| | çº¿ç¨‹æ•° | å·¥ä½œçº¿ç¨‹æ•° | (è‡ªåŠ¨) |
| | ç¦ç”¨HLTV | ç¦ç”¨è§‚æˆ˜ç³»ç»Ÿ | å¦ |
| | å¯ç”¨æ§åˆ¶å° | æ˜¾ç¤ºæ§åˆ¶å°çª—å£ | æ˜¯ |
| **æ¸¸æˆè§„åˆ™** |
| | BOTæ•°é‡ | AIæœºå™¨äººæ•°é‡ | 0 |
| | BOTéš¾åº¦ | æœºå™¨äººéš¾åº¦(0-3) | 2 (å›°éš¾) |
| | è¸¢å‡ºé—²ç½®æ—¶é—´ | è‡ªåŠ¨è¸¢å‡ºé—²ç½®ç©å®¶çš„æ—¶é—´ | (ä¸è¸¢å‡º) |
| | å¯ç”¨ä½œå¼Š | å…è®¸ä½œå¼Šå‘½ä»¤ | å¦ |
| **æ—¥å¿—è®¾ç½®** |
| | å¯ç”¨æ—¥å¿— | è®°å½•æœåŠ¡å™¨æ—¥å¿— | æ˜¯ |
| | æ§åˆ¶å°æ—¥å¿—å†™å…¥ | æ§åˆ¶å°è¾“å‡ºä¿å­˜åˆ°æ–‡ä»¶ | å¦ |
| | æ—¥å¿—å›æ˜¾ | åœ¨æ§åˆ¶å°æ˜¾ç¤ºæ—¥å¿— | æ˜¯ |

### 12.3 ç”¨æˆ·ä½“éªŒæ”¹è¿›

1. **åˆ†ç±»å±•ç¤º**: ä½¿ç”¨Tabé¡µç­¾å°†é…ç½®é¡¹æŒ‰ç±»åˆ«ç»„ç»‡ï¼Œé¿å…ç•Œé¢æ‚ä¹±
2. **å·¥å…·æç¤º**: æ¯ä¸ªé…ç½®é¡¹éƒ½æœ‰è¯¦ç»†çš„Tooltipè¯´æ˜
3. **é»˜è®¤å€¼**: æ‰€æœ‰é…ç½®é¡¹éƒ½æœ‰åˆç†çš„é»˜è®¤å€¼ï¼Œæ–°æ‰‹ç”¨æˆ·å¯ç›´æ¥ä½¿ç”¨
4. **è¾“å…¥éªŒè¯**: å¯¹å…³é”®å‚æ•°è¿›è¡Œå®æ—¶éªŒè¯ï¼Œé˜²æ­¢é”™è¯¯é…ç½®
5. **å¯é€‰å‚æ•°**: é«˜çº§é€‰é¡¹æ ‡è®°ä¸ºå¯é€‰ï¼Œç•™ç©ºæ—¶ä¸ä¼šç”Ÿæˆå¯¹åº”çš„å¯åŠ¨å‚æ•°

### 12.4 å›½é™…åŒ–æ”¯æŒ

æ‰€æœ‰é…ç½®é¡¹çš„æ ‡ç­¾ã€æç¤ºä¿¡æ¯éƒ½å®Œå…¨æ”¯æŒå›½é™…åŒ–ï¼š
- **ä¸­æ–‡**: å®Œæ•´çš„ä¸­æ–‡ç•Œé¢å’Œè¯´æ˜
- **è‹±æ–‡**: å®Œæ•´çš„è‹±æ–‡ç•Œé¢å’Œè¯´æ˜
- ç”¨æˆ·å¯åœ¨è®¾ç½®ä¸­ä¸€é”®åˆ‡æ¢è¯­è¨€

### 12.5 æ‰©å±•æ€§

é…ç½®ç³»ç»Ÿè®¾è®¡è€ƒè™‘äº†æœªæ¥çš„æ‰©å±•éœ€æ±‚ï¼š
- **CustomArgs**: æ”¯æŒæ·»åŠ ä»»æ„è‡ªå®šä¹‰å¯åŠ¨å‚æ•°
- **Provideræœºåˆ¶**: ä¸åŒå¹³å°å¯ä»¥æ‰©å±•ç‰¹å®šçš„å¯åŠ¨å‚æ•°
- **é…ç½®æ¨¡æ¿**: æœªæ¥å¯æ”¯æŒä¿å­˜å’ŒåŠ è½½é…ç½®æ¨¡æ¿

---

## 13. Workshop åœ°å›¾å†å²ç®¡ç†

**æ›´æ–°æ—¶é—´**: 2025-10-26

CSP2 å®ç°äº†å®Œæ•´çš„ Workshop åœ°å›¾å†å²ç®¡ç†åŠŸèƒ½ï¼Œä» cs2servergui é¡¹ç›®ç§»æ¤å¹¶æ”¹è¿›ã€‚

### 13.1 åŠŸèƒ½æ¦‚è¿°

Workshop åœ°å›¾å†å²ç®¡ç†ç³»ç»Ÿè‡ªåŠ¨è®°å½•æœåŠ¡å™¨åŠ è½½çš„ Workshop åˆ›æ„å·¥åŠåœ°å›¾ï¼ŒåŒ…æ‹¬ï¼š

- **è‡ªåŠ¨è®°å½•**: æ£€æµ‹ `host_workshop_map` å‘½ä»¤å¹¶è‡ªåŠ¨è®°å½•
- **Steam API é›†æˆ**: è·å–åœ°å›¾åç§°ã€ä½œè€…ã€æè¿°ç­‰è¯¦ç»†ä¿¡æ¯
- **é¢„è§ˆå›¾ä¸‹è½½**: è‡ªåŠ¨ä¸‹è½½å¹¶ç¼“å­˜åœ°å›¾é¢„è§ˆå›¾
- **åŠ è½½ç»Ÿè®¡**: è®°å½•åœ°å›¾åŠ è½½æ¬¡æ•°å’Œæœ€ååŠ è½½æ—¶é—´
- **å¤šæœåŠ¡å™¨æ”¯æŒ**: æ¯ä¸ªæœåŠ¡å™¨ç‹¬ç«‹çš„åœ°å›¾å†å²

### 13.2 æŠ€æœ¯æ¶æ„

```
ç”¨æˆ·æ‰§è¡Œå‘½ä»¤: host_workshop_map 123456
    â†“
LogConsoleViewModel æ£€æµ‹å‘½ä»¤
    â†“
ISteamWorkshopService è§£æ Workshop ID
    â†“
è°ƒç”¨ Steam API è·å–åœ°å›¾ä¿¡æ¯
    â†“
ä¸‹è½½åœ°å›¾é¢„è§ˆå›¾åˆ°æœ¬åœ°
    â†“
IMapHistoryService ä¿å­˜åˆ° JSON æ–‡ä»¶
    â†“
MapHistoryViewModel å±•ç¤ºå†å²è®°å½•
```

### 13.3 æ ¸å¿ƒç»„ä»¶

#### **ISteamWorkshopService** - Steam Workshop æœåŠ¡

```csharp
public interface ISteamWorkshopService
{
    // è·å–åœ°å›¾ä¿¡æ¯ï¼ˆä» Steam APIï¼‰
    Task<MapHistoryEntry?> GetMapInfoAsync(string workshopId);
    
    // ä¸‹è½½é¢„è§ˆå›¾
    Task<string?> DownloadPreviewImageAsync(string previewUrl, string workshopId);
    
    // è§£æ Workshop IDï¼ˆæ”¯æŒ URL å’Œçº¯ IDï¼‰
    string? ParseWorkshopId(string url);
}
```

**ç‰¹æ€§**:
- è°ƒç”¨ Steam Web API: `ISteamRemoteStorage/GetPublishedFileDetails`
- æ”¯æŒè§£æ URL: `https://steamcommunity.com/sharedfiles/filedetails/?id=123456`
- æ”¯æŒçº¯æ•°å­— ID: `123456`
- è‡ªåŠ¨ä¸‹è½½é¢„è§ˆå›¾åˆ° `data/workshop_previews/`

#### **IMapHistoryService** - åœ°å›¾å†å²æœåŠ¡

```csharp
public interface IMapHistoryService
{
    // è·å–æ‰€æœ‰æœåŠ¡å™¨çš„åœ°å›¾å†å²
    Task<List<MapHistoryEntry>> GetAllEntriesAsync();
    
    // è·å–æŒ‡å®šæœåŠ¡å™¨çš„åœ°å›¾å†å²
    Task<List<MapHistoryEntry>> GetServerEntriesAsync(string serverId);
    
    // è®°å½•åœ°å›¾åŠ è½½ï¼ˆè‡ªåŠ¨è·å–ä¿¡æ¯ï¼‰
    Task RecordMapLoadAsync(string serverId, string workshopId);
    
    // åˆ é™¤åœ°å›¾è®°å½•
    Task<bool> DeleteEntryAsync(string serverId, string workshopId);
    
    // æ¸…ç©ºå†å²è®°å½•
    Task ClearServerHistoryAsync(string serverId);
}
```

**å­˜å‚¨æ ¼å¼**: JSON
```json
{
  "server-id-1": [
    {
      "workshopId": "3070212191",
      "mapName": "de_dust2_rework",
      "authorId": "76561198012345678",
      "description": "Dust2 Rework Map",
      "firstLoadedAt": "2025-10-26T14:30:00",
      "lastLoadedAt": "2025-10-26T15:45:00",
      "loadCount": 5,
      "previewImagePath": "data/workshop_previews/preview_3070212191.jpg",
      "previewImageUrl": "https://steamuserimages-a.akamaihd.net/...",
      "fileSize": 12345678,
      "timeCreated": 1698765432,
      "timeUpdated": 1698876543
    }
  ]
}
```

### 13.4 æ•°æ®æ¨¡å‹

```csharp
public class MapHistoryEntry
{
    public string WorkshopId { get; set; }          // Workshop ID
    public string MapName { get; set; }             // åœ°å›¾åç§°
    public string AuthorId { get; set; }            // ä½œè€… Steam ID
    public string Description { get; set; }         // åœ°å›¾æè¿°
    public DateTime FirstLoadedAt { get; set; }     // é¦–æ¬¡åŠ è½½æ—¶é—´
    public DateTime LastLoadedAt { get; set; }      // æœ€ååŠ è½½æ—¶é—´
    public int LoadCount { get; set; }              // åŠ è½½æ¬¡æ•°
    public string PreviewImagePath { get; set; }    // é¢„è§ˆå›¾æœ¬åœ°è·¯å¾„
    public string PreviewImageUrl { get; set; }     // é¢„è§ˆå›¾ URL
    public long FileSize { get; set; }              // æ–‡ä»¶å¤§å°
    
    // è®¡ç®—å±æ€§
    public string WorkshopUrl => $"https://steamcommunity.com/sharedfiles/filedetails/?id={WorkshopId}";
    public bool HasPreviewImage => !string.IsNullOrEmpty(PreviewImagePath) && File.Exists(PreviewImagePath);
}
```

### 13.5 è‡ªåŠ¨è®°å½•æœºåˆ¶

**LogConsoleViewModel** åœ¨å‘é€å‘½ä»¤æ—¶è‡ªåŠ¨æ£€æµ‹ï¼š

```csharp
private async Task TryRecordWorkshopMapAsync(string command)
{
    // 1. æ£€æµ‹å‘½ä»¤æ˜¯å¦ä¸º host_workshop_map
    if (!command.Trim().ToLower().StartsWith("host_workshop_map"))
        return;
    
    // 2. æå– Workshop ID å‚æ•°
    var workshopId = _workshopService.ParseWorkshopId(mapInput);
    
    // 3. å¼‚æ­¥è®°å½•ï¼ˆä¸é˜»å¡UIï¼‰
    _ = Task.Run(async () =>
    {
        await _mapHistoryService.RecordMapLoadAsync(serverId, workshopId);
    });
}
```

**è§¦å‘åœºæ™¯**:
- ç”¨æˆ·åœ¨æ—¥å¿—æ§åˆ¶å°è¾“å…¥ `host_workshop_map 123456`
- ç”¨æˆ·åœ¨æ—¥å¿—æ§åˆ¶å°è¾“å…¥ `host_workshop_map https://steamcommunity.com/sharedfiles/filedetails/?id=123456`
- é€šè¿‡å¿«æ·å‘½ä»¤æ‰§è¡Œ `host_workshop_map`

### 13.6 UI åŠŸèƒ½

#### **åœ°å›¾å†å²é¡µé¢** (`MapHistoryView.xaml`)

**å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—ºï¸ Workshop åœ°å›¾å†å²           [ğŸ”„ åˆ·æ–°] [ğŸ—‘ï¸ æ¸…ç©ºå†å²]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å…± 12 ä¸ªåœ°å›¾ â€¢ 48 æ¬¡åŠ è½½                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [é¢„è§ˆå›¾]  de_dust2_rework                               â”‚ â”‚
â”‚  â”‚           ğŸ†” Workshop ID: 3070212191                    â”‚ â”‚
â”‚  â”‚           ğŸ• æœ€ååŠ è½½: 2025-10-26 15:45:00              â”‚ â”‚
â”‚  â”‚           ğŸ“Š åŠ è½½æ¬¡æ•°: 5                    [ğŸŒ è®¿é—®]   â”‚ â”‚
â”‚  â”‚                                            [ğŸ—‘ï¸ åˆ é™¤]   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [é¢„è§ˆå›¾]  aim_map_pro                                   â”‚ â”‚
â”‚  â”‚           ...                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ˜¾ç¤ºæœåŠ¡å™¨ My Server çš„åœ°å›¾å†å²                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ“ä½œ**:
- **è®¿é—® Workshop**: æ‰“å¼€æµè§ˆå™¨è·³è½¬åˆ°åœ°å›¾çš„ Steam Workshop é¡µé¢
- **åˆ é™¤è®°å½•**: åˆ é™¤åœ°å›¾å†å²è®°å½•å’Œé¢„è§ˆå›¾
- **åˆ·æ–°åˆ—è¡¨**: é‡æ–°åŠ è½½åœ°å›¾å†å²
- **æ¸…ç©ºå†å²**: æ¸…ç©ºå½“å‰æœåŠ¡å™¨æˆ–æ‰€æœ‰æœåŠ¡å™¨çš„åœ°å›¾å†å²

#### **ç©ºçŠ¶æ€æç¤º**

å½“æ²¡æœ‰åœ°å›¾å†å²æ—¶ï¼š
```
        ğŸ—ºï¸
  è¿˜æ²¡æœ‰åŠ è½½è¿‡ Workshop åœ°å›¾
  
  åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨ host_workshop_map <ID> å‘½ä»¤
  åŠ è½½çš„åœ°å›¾å°†è‡ªåŠ¨è®°å½•åœ¨è¿™é‡Œ
```

### 13.7 Steam API é›†æˆ

**API ç«¯ç‚¹**:
```
POST https://api.steampowered.com/ISteamRemoteStorage/GetPublishedFileDetails/v1/?format=json

Body (Form Data):
  - itemcount: 1
  - publishedfileids[0]: <workshop_id>
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "response": {
    "publishedfiledetails": [
      {
        "publishedfileid": "3070212191",
        "title": "de_dust2_rework",
        "creator": "76561198012345678",
        "description": "Dust2 Rework",
        "preview_url": "https://steamuserimages-a.akamaihd.net/.../preview.jpg",
        "file_size": "12345678",
        "time_created": 1698765432,
        "time_updated": 1698876543
      }
    ]
  }
}
```

**é”™è¯¯å¤„ç†**:
- API è¯·æ±‚å¤±è´¥: åˆ›å»ºé»˜è®¤æ¡ç›®ï¼ˆä½¿ç”¨ Workshop ID ä½œä¸ºåç§°ï¼‰
- é¢„è§ˆå›¾ä¸‹è½½å¤±è´¥: ä½¿ç”¨å ä½ç¬¦å›¾æ ‡
- ç½‘ç»œç¦»çº¿: ä»å¯æŸ¥çœ‹å·²ç¼“å­˜çš„åœ°å›¾å†å²

### 13.8 æ€§èƒ½ä¼˜åŒ–

1. **å¼‚æ­¥å¤„ç†**: åœ°å›¾è®°å½•åœ¨åå°çº¿ç¨‹æ‰§è¡Œï¼Œä¸é˜»å¡UI
2. **é¢„è§ˆå›¾ç¼“å­˜**: å·²ä¸‹è½½çš„é¢„è§ˆå›¾ä¸ä¼šé‡å¤ä¸‹è½½
3. **å»¶è¿ŸåŠ è½½**: åœ°å›¾å†å²é¡µé¢æ‰“å¼€æ—¶æ‰åŠ è½½æ•°æ®
4. **æ–‡ä»¶é”æœºåˆ¶**: ä½¿ç”¨ `SemaphoreSlim` é˜²æ­¢å¹¶å‘å†™å…¥å†²çª

### 13.9 ä¸ cs2servergui çš„å¯¹æ¯”

| ç‰¹æ€§ | cs2servergui | CSP2 | æ”¹è¿› |
|-----|-------------|------|------|
| **å­˜å‚¨æ ¼å¼** | CSV (rapidcsv) | JSON | æ›´æ˜“æ‰©å±• |
| **å¤šæœåŠ¡å™¨** | å¦ | æ˜¯ | æ¯æœåŠ¡å™¨ç‹¬ç«‹å†å² |
| **URL è§£æ** | æ˜¯ | æ˜¯ | - |
| **é¢„è§ˆå›¾ç¼“å­˜** | æ˜¯ | æ˜¯ | - |
| **åŠ è½½æ¬¡æ•°** | å¦ | æ˜¯ | ç»Ÿè®¡åŠŸèƒ½å¢å¼º |
| **å¼‚æ­¥å¤„ç†** | éƒ¨åˆ† | å®Œå…¨å¼‚æ­¥ | UI æ›´æµç•… |
| **é”™è¯¯å¤„ç†** | åŸºç¡€ | å®Œå–„ | ç¦»çº¿å¯ç”¨ |

---

## 14. æ—¥å¿—æ§åˆ¶å°å¢å¼ºåŠŸèƒ½

**æ›´æ–°æ—¶é—´**: 2025-10-26

CSP2 ä» cs2servergui é¡¹ç›®ç§»æ¤äº†å¤šé¡¹å®ç”¨åŠŸèƒ½ï¼Œæå¤§æå‡äº†å‘½ä»¤è¡Œäº¤äº’ä½“éªŒã€‚

### 14.1 å‘½ä»¤å†å²å¯¼èˆª

**åŠŸèƒ½**: ä½¿ç”¨ â†‘â†“ ç®­å¤´é”®æµè§ˆå†å²å‘½ä»¤ï¼Œç±»ä¼¼ Linux Shell

**æŠ€æœ¯å®ç°**:
```csharp
// CommandHistory.cs
public class CommandHistory
{
    public string? GetOlder();  // â†‘ é”®
    public string? GetNewer();  // â†“ é”®
    public void Add(string command);
}
```

**ç‰¹æ€§**:
- æŒä¹…åŒ–åˆ° `data/command_history.txt`
- è‡ªåŠ¨å»é‡ï¼ˆè¿ç»­ç›¸åŒå‘½ä»¤ä¸é‡å¤è®°å½•ï¼‰
- é™åˆ¶å†å²è®°å½•æ•°é‡ï¼ˆé»˜è®¤ 100 æ¡ï¼‰
- å…‰æ ‡è‡ªåŠ¨ç§»åˆ°æœ«å°¾

**ä½¿ç”¨æ–¹æ³•**:
1. è¾“å…¥å‘½ä»¤åæŒ‰ Enter å‘é€
2. æŒ‰ â†‘ é”®æŸ¥çœ‹ä¸Šä¸€æ¡å‘½ä»¤
3. æŒ‰ â†“ é”®æŸ¥çœ‹ä¸‹ä¸€æ¡å‘½ä»¤

---

### 14.2 RCON å®¢æˆ·ç«¯æ”¯æŒ

**åŠŸèƒ½**: é€šè¿‡ RCON åè®®è¿œç¨‹ç®¡ç†æœåŠ¡å™¨

**æ¶æ„è®¾è®¡**:
```
IRCONClient (æ¥å£)
    â†“
RCONClient (å®ç° Source RCON åè®®)
    â†“
LogConsoleViewModel (é›†æˆ RCON)
    â†“
UI (RCON æ§åˆ¶é¢æ¿ + é…ç½®å¯¹è¯æ¡†)
```

**RCON åè®®** (Source Engine):
```
Packet = Size (4 bytes) + ID (4 bytes) + Type (4 bytes) + Body (N bytes) + Null (2 bytes)

Types:
- SERVERDATA_AUTH (3): è®¤è¯è¯·æ±‚
- SERVERDATA_AUTH_RESPONSE (2): è®¤è¯å“åº”
- SERVERDATA_EXECCOMMAND (2): æ‰§è¡Œå‘½ä»¤
- SERVERDATA_RESPONSE_VALUE (0): å‘½ä»¤å“åº”
```

**ç‰¹æ€§**:
- âœ… Source RCON åè®®å®Œæ•´å®ç°
- âœ… å¼‚æ­¥è¿æ¥ï¼Œä¸é˜»å¡UI
- âœ… è®¤è¯å’Œå‘½ä»¤å‘é€
- âœ… è¿æ¥çŠ¶æ€å¯è§†åŒ–ï¼ˆç»¿è‰²=å·²è¿æ¥ï¼Œç°è‰²=æœªè¿æ¥ï¼‰
- âœ… æ”¯æŒåˆ‡æ¢ RCON/stdin æ¨¡å¼
- âœ… RCON å“åº”æ˜¾ç¤ºåœ¨æ—¥å¿—ä¸­
- âœ… **RCON é…ç½®å¯¹è¯æ¡†** (æ–°å¢)
- âœ… **è¿æ¥æµ‹è¯•åŠŸèƒ½** (æ–°å¢)
- âœ… **æ™ºèƒ½é‡è¿æœºåˆ¶** (æ–°å¢)

**é…ç½®æ¨¡å‹**:
```csharp
public class RCONConfig
{
    public bool Enabled { get; set; } = false;
    public string Host { get; set; } = "127.0.0.1";
    public int Port { get; set; } = 27015;
    public string Password { get; set; } = string.Empty;
    public int Timeout { get; set; } = 5000;
}
```

**RCON é…ç½®å¯¹è¯æ¡†** (æ–°å¢):
- æ–‡ä»¶: `Views/Dialogs/RCONConfigDialog.xaml`
- åŠŸèƒ½:
  - ğŸ”§ é…ç½® RCON è¿æ¥å‚æ•°ï¼ˆåœ°å€ã€ç«¯å£ã€å¯†ç ã€è¶…æ—¶ï¼‰
  - ğŸ§ª æµ‹è¯•è¿æ¥åŠŸèƒ½ï¼ˆéªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼‰
  - â„¹ï¸ å†…ç½®ä½¿ç”¨æŒ‡å—å’Œå‚æ•°è¯´æ˜
  - âœ… è¾“å…¥éªŒè¯ï¼ˆç«¯å£èŒƒå›´ã€è¶…æ—¶æ—¶é—´ç­‰ï¼‰
  - ğŸ’¾ ä¿å­˜åˆ°æœåŠ¡å™¨é…ç½®

**ä½¿ç”¨åœºæ™¯**:
- **è¿œç¨‹æœåŠ¡å™¨ç®¡ç†**: ç®¡ç†ä¸åœ¨æœ¬æœºçš„æœåŠ¡å™¨
- **æ›´å¯é çš„å‘½ä»¤æ‰§è¡Œ**: RCON æœ‰æ˜ç¡®çš„å“åº”ï¼Œstdin å¯èƒ½ä¸¢å¤±
- **è°ƒè¯•è¿œç¨‹æœåŠ¡å™¨**: æ— éœ€æœ¬åœ°å¯åŠ¨æœåŠ¡å™¨

**ä½¿ç”¨æ–¹æ³•**:

**æ–¹å¼1: é€šè¿‡é…ç½®å¯¹è¯æ¡†**
1. ç‚¹å‡»æ—¥å¿—æ§åˆ¶å° RCON åŒºåŸŸçš„ **âš™ï¸ é…ç½®** æŒ‰é’®
2. å¡«å†™ RCON å‚æ•°ï¼ˆåœ°å€ã€ç«¯å£ã€å¯†ç ã€è¶…æ—¶ï¼‰
3. ç‚¹å‡» **æµ‹è¯•è¿æ¥** éªŒè¯é…ç½®ï¼ˆå¯é€‰ï¼‰
4. å‹¾é€‰ **å¯ç”¨ RCON è¿æ¥**
5. ç‚¹å‡» **ä¿å­˜**
6. ç³»ç»Ÿè‡ªåŠ¨è¿æ¥ï¼ˆå¦‚æœå¯ç”¨ï¼‰

**æ–¹å¼2: å¿«é€Ÿå¯ç”¨**
1. ç¡®ä¿æœåŠ¡å™¨å·²é…ç½® RCON å¯†ç 
2. åœ¨æ—¥å¿—æ§åˆ¶å°å‹¾é€‰ "å¯ç”¨ RCON"
3. ç‚¹å‡» "è¿æ¥" æŒ‰é’®
4. å‘é€å‘½ä»¤è‡ªåŠ¨é€šè¿‡ RCON
5. å¯éšæ—¶åˆ‡æ¢å› stdin æ¨¡å¼

**RCON vs stdin å¯¹æ¯”**:
| ç‰¹æ€§ | RCON | stdin |
|-----|------|-------|
| è¿œç¨‹è®¿é—® | âœ… | âŒ ä»…æœ¬åœ° |
| å‘½ä»¤å“åº” | âœ… æœ‰å“åº” | âŒ æ— å“åº” |
| é…ç½®å¤æ‚åº¦ | ğŸŸ¡ éœ€è¦å¯†ç  | âœ… æ— éœ€é…ç½® |
| æ¨èåœºæ™¯ | è¿œç¨‹æœåŠ¡å™¨ | æœ¬åœ°æœåŠ¡å™¨ |

**è¯¦ç»†æ–‡æ¡£**: å‚è§ `docs/RCONåŠŸèƒ½å®Œå–„è¯´æ˜.md`

---

### 13.3 å¿«æ·å‘½ä»¤ (Quick Commands)

**åŠŸèƒ½**: ä¿å­˜å¸¸ç”¨å‘½ä»¤ä¸ºä¸€é”®æ‰§è¡ŒæŒ‰é’®

**æ•°æ®æ¨¡å‹**:
```csharp
// ServerConfig.cs
public List<string> QuickCommands { get; set; } = new();
```

**UI è®¾è®¡**:
```
âš¡ å¿«æ·å‘½ä»¤

[â–¶ mp_restartgame 1 âœ•]  [â–¶ sv_cheats 1 âœ•]  [â–¶ bot_kick all âœ•]

[â• æ·»åŠ å½“å‰å‘½ä»¤ä¸ºå¿«æ·å‘½ä»¤]
```

**ç‰¹æ€§**:
- âœ… æ·»åŠ å½“å‰å‘½ä»¤ä¸ºå¿«æ·å‘½ä»¤
- âœ… ä¸€é”®æ‰§è¡Œå¿«æ·å‘½ä»¤
- âœ… åˆ é™¤å¿«æ·å‘½ä»¤
- âœ… è‡ªåŠ¨ä¿å­˜åˆ°æœåŠ¡å™¨é…ç½®
- âœ… æ¯ä¸ªæœåŠ¡å™¨ç‹¬ç«‹çš„å¿«æ·å‘½ä»¤åˆ—è¡¨

**ä½¿ç”¨æ–¹æ³•**:
1. åœ¨å‘½ä»¤è¾“å…¥æ¡†è¾“å…¥å¸¸ç”¨å‘½ä»¤ï¼ˆå¦‚ `mp_restartgame 1`ï¼‰
2. ç‚¹å‡» "â• æ·»åŠ å½“å‰å‘½ä»¤ä¸ºå¿«æ·å‘½ä»¤"
3. å¿«æ·å‘½ä»¤æŒ‰é’®å‡ºç°åœ¨è¾“å…¥æ¡†ä¸‹æ–¹
4. ç‚¹å‡» â–¶ æŒ‰é’®æ‰§è¡Œå‘½ä»¤
5. ç‚¹å‡» âœ• æŒ‰é’®åˆ é™¤å‘½ä»¤

**å…¸å‹å¿«æ·å‘½ä»¤**:
- `mp_restartgame 1` - é‡å¯å›åˆ
- `sv_cheats 1` - å¯ç”¨ä½œå¼Š
- `bot_kick` - è¸¢å‡ºæ‰€æœ‰BOT
- `mp_warmup_end` - ç»“æŸçƒ­èº«
- `changelevel de_dust2` - åˆ‡æ¢åœ°å›¾

---

### 13.4 åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | CSP2 (æ—§) | CSP2 (æ–°) | cs2servergui |
|------|-----------|-----------|--------------|
| å‘½ä»¤å‘é€ | âœ… stdin | âœ… stdin + RCON | âœ… RCON |
| å‘½ä»¤å†å² | âŒ | âœ… â†‘â†“ å¯¼èˆª | âœ… |
| å¿«æ·å‘½ä»¤ | âŒ | âœ… | âœ… |
| æ—¥å¿—æŸ¥çœ‹ | âœ… | âœ… | âœ… |
| æ—¥å¿—å¯¼å‡º | âœ… | âœ… | âŒ |
| å¤šæœåŠ¡å™¨ | âœ… | âœ… | éƒ¨åˆ† |

---

### 13.5 æœªæ¥è®¡åˆ’

ä»¥ä¸‹åŠŸèƒ½æ¥è‡ª cs2serverguiï¼Œè®¡åˆ’åœ¨åç»­ç‰ˆæœ¬å®ç°ï¼š

**P1 ä¼˜å…ˆçº§**:
- **Workshop åœ°å›¾åŠ©æ‰‹**: ä¸“ç”¨è¾“å…¥æ¡†ï¼Œæ”¯æŒåœ°å›¾ ID/URLï¼Œè‡ªåŠ¨æ‰§è¡Œ `host_workshop_map`
- **å¤šå‘½ä»¤å†å²ç±»å‹**: ä¸åŒè¾“å…¥æ¡†ç‹¬ç«‹çš„å†å²è®°å½•ï¼ˆé€šç”¨å‘½ä»¤ã€åœ°å›¾ã€è„šæœ¬ï¼‰

**P2 ä¼˜å…ˆçº§**:
- **åœ°å›¾å†å²è®°å½•**: æ˜¾ç¤ºå·²åŠ è½½çš„ Workshop åœ°å›¾ï¼Œå¸¦é¢„è§ˆå›¾
- **Steam API é›†æˆ**: è·å–åœ°å›¾ä¿¡æ¯ï¼ˆåç§°ã€ä½œè€…ã€æè¿°ï¼‰

---

## 15. ä¸‹ä¸€æ­¥

é˜…è¯»å®Œæœ¬æ–‡æ¡£åï¼Œè¯·æŸ¥çœ‹ï¼š
- `02-é¡¹ç›®ç»“æ„è¯´æ˜.md` - äº†è§£ä»£ç ç»„ç»‡æ–¹å¼
- `03-å¼€å‘è·¯çº¿å›¾.md` - äº†è§£å¼€å‘è®¡åˆ’
- `04-WPFå¿«é€Ÿå…¥é—¨.md` - å­¦ä¹ WPFåŸºç¡€çŸ¥è¯†
- `05-i18nå›½é™…åŒ–ä½¿ç”¨æŒ‡å—.md` - äº†è§£å¦‚ä½•ä½¿ç”¨å›½é™…åŒ–åŠŸèƒ½
- `cs2servergui-feature-analysis.md` - cs2servergui åŠŸèƒ½åˆ†æ
- `cs2servergui-porting-summary.md` - åŠŸèƒ½ç§»æ¤æ€»ç»“

---

**æ–‡æ¡£ç»“æŸ**

