<Window x:Class="CSP2.Desktop.Views.Dialogs.ServerInstallDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="å®‰è£… CS2 æœåŠ¡å™¨" 
        Height="600" 
        Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{StaticResource BackgroundBrush}">
    
    <Grid Margin="40">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- æ ‡é¢˜åŒºåŸŸ -->
        <StackPanel Grid.Row="0" Margin="0,0,0,32">
            <Border Background="{StaticResource PrimaryPaleBrush}"
                    Width="80"
                    Height="80"
                    CornerRadius="40"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,24">
                <TextBlock Text="â¬‡ï¸"
                           FontSize="40"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>
            </Border>
            
            <TextBlock Text="å®‰è£… CS2 æœåŠ¡å™¨" 
                       FontSize="32" 
                       FontWeight="Bold"
                       Foreground="{StaticResource TextPrimaryBrush}"
                       HorizontalAlignment="Center"/>
            <TextBlock Text="é€‰æ‹©å®‰è£…æ–¹å¼æˆ–ä½¿ç”¨çŽ°æœ‰å®‰è£…" 
                       FontSize="16" 
                       Foreground="{StaticResource TextSecondaryBrush}"
                       HorizontalAlignment="Center"
                       Margin="0,12,0,0"/>
        </StackPanel>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <Grid Grid.Row="1" x:Name="ContentGrid">
            <!-- æ­¥éª¤1ï¼šé€‰æ‹©å®‰è£…æ–¹å¼ -->
            <StackPanel x:Name="Step1Panel" Visibility="Visible">
                <TextBlock Text="è¯·é€‰æ‹©å®‰è£…æ–¹å¼" 
                           FontSize="20" 
                           FontWeight="Bold"
                           Foreground="{StaticResource TextPrimaryBrush}"
                           Margin="0,0,0,24"/>

                <!-- SteamCMD ä¸‹è½½ -->
                <Border Style="{StaticResource HoverCardStyle}"
                        Padding="24"
                        Margin="0,0,0,16"
                        MouseDown="SteamCmdOption_Click"
                        Tag="steamcmd">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0"
                                Background="{StaticResource PrimaryPaleBrush}"
                                Width="56"
                                Height="56"
                                CornerRadius="12"
                                Margin="0,0,20,0">
                            <TextBlock Text="ðŸ“¦"
                                       FontSize="28"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"/>
                        </Border>

                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="ä½¿ç”¨ SteamCMD ä¸‹è½½"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                            <TextBlock Text="è‡ªåŠ¨ä¸‹è½½æœ€æ–°çš„ CS2 æœåŠ¡å™¨æ–‡ä»¶ï¼ˆçº¦30GBï¼‰"
                                       FontSize="14"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       Margin="0,6,0,0"/>
                            <TextBlock Text="âœ… æŽ¨è â€¢ è‡ªåŠ¨æ›´æ–° â€¢ ç‹¬ç«‹ç®¡ç†"
                                       FontSize="12"
                                       Foreground="{StaticResource SuccessBrush}"
                                       Margin="0,8,0,0"/>
                        </StackPanel>

                        <TextBlock Grid.Column="2"
                                   Text="â†’"
                                   FontSize="32"
                                   Foreground="{StaticResource Gray400Brush}"
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>

                <!-- ä½¿ç”¨çŽ°æœ‰å®‰è£… -->
                <Border Style="{StaticResource HoverCardStyle}"
                        Padding="24"
                        MouseDown="ExistingInstallOption_Click"
                        Tag="existing">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0"
                                Background="{StaticResource InfoLightBrush}"
                                Width="56"
                                Height="56"
                                CornerRadius="12"
                                Margin="0,0,20,0">
                            <TextBlock Text="ðŸ“"
                                       FontSize="28"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"/>
                        </Border>

                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="ä½¿ç”¨çŽ°æœ‰å®‰è£…"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                            <TextBlock x:Name="DetectedInstallsText"
                                       Text="æ­£åœ¨æ‰«æ..."
                                       FontSize="14"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       Margin="0,6,0,0"/>
                            <TextBlock Text="ðŸ’¡ èŠ‚çœç©ºé—´ â€¢ å…±äº«æ–‡ä»¶ â€¢ å¿«é€Ÿå¯åŠ¨"
                                       FontSize="12"
                                       Foreground="{StaticResource InfoBrush}"
                                       Margin="0,8,0,0"/>
                        </StackPanel>

                        <TextBlock Grid.Column="2"
                                   Text="â†’"
                                   FontSize="32"
                                   Foreground="{StaticResource Gray400Brush}"
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>
            </StackPanel>

            <!-- æ­¥éª¤2ï¼šé…ç½®æœåŠ¡å™¨ -->
            <ScrollViewer x:Name="Step2Panel" Visibility="Collapsed" VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <TextBlock Text="é…ç½®æœåŠ¡å™¨ä¿¡æ¯" 
                               FontSize="20" 
                               FontWeight="Bold"
                               Foreground="{StaticResource TextPrimaryBrush}"
                               Margin="0,0,0,24"/>

                    <!-- æœåŠ¡å™¨åç§° -->
                    <TextBlock Text="æœåŠ¡å™¨åç§°" 
                               FontSize="14" 
                               FontWeight="SemiBold"
                               Foreground="{StaticResource TextPrimaryBrush}"
                               Margin="0,0,0,8"/>
                    <TextBox x:Name="ServerNameTextBox"
                             Text="æˆ‘çš„ CS2 æœåŠ¡å™¨"
                             Style="{StaticResource ModernTextBox}"
                             Margin="0,0,0,20"/>

                    <!-- å®‰è£…è·¯å¾„ï¼ˆä»… SteamCMDï¼‰ -->
                    <StackPanel x:Name="InstallPathPanel" Visibility="Collapsed">
                        <TextBlock Text="å®‰è£…è·¯å¾„" 
                                   FontSize="14" 
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   Margin="0,0,0,8"/>
                        <Grid Margin="0,0,0,6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="InstallPathTextBox"
                                     Grid.Column="0"
                                     Style="{StaticResource ModernTextBox}"/>
                            <Button Grid.Column="1"
                                    Content="ðŸ“"
                                    Click="BrowseInstallPath_Click"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Margin="12,0,0,0"
                                    Width="40"
                                    Height="40"
                                    FontSize="16"/>
                        </Grid>
                        <TextBlock Text="æœåŠ¡å™¨æ–‡ä»¶å°†ä¸‹è½½åˆ°æ­¤ç›®å½•" 
                                   FontSize="12" 
                                   Foreground="{StaticResource TextTertiaryBrush}"
                                   Margin="0,0,0,20"/>
                    </StackPanel>

                    <!-- é€‰æ‹©çŽ°æœ‰å®‰è£…ï¼ˆä»…çŽ°æœ‰å®‰è£…ï¼‰ -->
                    <StackPanel x:Name="ExistingInstallPanel" Visibility="Collapsed">
                        <TextBlock Text="é€‰æ‹©çŽ°æœ‰å®‰è£…" 
                                   FontSize="14" 
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   Margin="0,0,0,8"/>
                        <ComboBox x:Name="ExistingInstallComboBox"
                                  Style="{StaticResource ModernComboBox}"
                                  Margin="0,0,0,20"/>
                    </StackPanel>

                    <!-- ç½‘ç»œé…ç½® -->
                    <Border Background="{StaticResource SurfaceBrush}"
                            CornerRadius="10"
                            Padding="20"
                            Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock Text="ç½‘ç»œé…ç½®" 
                                       FontSize="16" 
                                       FontWeight="Bold"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       Margin="0,0,0,16"/>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="12"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="IPåœ°å€" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                    <TextBox x:Name="IpAddressTextBox"
                                             Text="0.0.0.0"
                                             Style="{StaticResource ModernTextBox}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="ç«¯å£" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                    <TextBox x:Name="PortTextBox"
                                             Text="27015"
                                             Style="{StaticResource ModernTextBox}"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- æ¸¸æˆé…ç½® -->
                    <Border Background="{StaticResource SurfaceBrush}"
                            CornerRadius="10"
                            Padding="20">
                        <StackPanel>
                            <TextBlock Text="æ¸¸æˆé…ç½®" 
                                       FontSize="16" 
                                       FontWeight="Bold"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       Margin="0,0,0,16"/>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="12"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="12"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Grid.Column="0">
                                    <TextBlock Text="åˆå§‹åœ°å›¾" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                    <TextBox x:Name="MapTextBox"
                                             Text="de_dust2"
                                             Style="{StaticResource ModernTextBox}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="0" Grid.Column="2">
                                    <TextBlock Text="æœ€å¤§çŽ©å®¶" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                    <TextBox x:Name="MaxPlayersTextBox"
                                             Text="10"
                                             Style="{StaticResource ModernTextBox}"/>
                                </StackPanel>

                                <StackPanel Grid.Row="2" Grid.Column="0">
                                    <TextBlock Text="Tick Rate" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                    <ComboBox x:Name="TickRateComboBox"
                                              Style="{StaticResource ModernComboBox}"
                                              SelectedIndex="1">
                                        <ComboBoxItem Content="64"/>
                                        <ComboBoxItem Content="128"/>
                                    </ComboBox>
                                </StackPanel>

                                <StackPanel Grid.Row="2" Grid.Column="2">
                                    <TextBlock Text="åœ°å›¾ç»„" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,6"/>
                                    <TextBox x:Name="MapGroupTextBox"
                                             Text="mg_active"
                                             Style="{StaticResource ModernTextBox}"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>

            <!-- æ­¥éª¤3ï¼šå®‰è£…è¿›åº¦ -->
            <StackPanel x:Name="Step3Panel" Visibility="Collapsed" VerticalAlignment="Center">
                <Border Background="{StaticResource PrimaryPaleBrush}"
                        Width="120"
                        Height="120"
                        CornerRadius="60"
                        HorizontalAlignment="Center"
                        Margin="0,0,0,32">
                    <TextBlock x:Name="ProgressIconTextBlock"
                               Text="â¬‡ï¸"
                               FontSize="64"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Border>

                <TextBlock x:Name="ProgressTitleTextBlock"
                           Text="æ­£åœ¨å®‰è£…æœåŠ¡å™¨..."
                           FontSize="24"
                           FontWeight="Bold"
                           Foreground="{StaticResource TextPrimaryBrush}"
                           HorizontalAlignment="Center"/>
                
                <TextBlock x:Name="ProgressMessageTextBlock"
                           Text="æ­£åœ¨å‡†å¤‡..."
                           FontSize="16"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           HorizontalAlignment="Center"
                           TextAlignment="Center"
                           TextWrapping="Wrap"
                           Margin="0,12,0,32"
                           MaxWidth="500"/>

                <Border Background="{StaticResource SurfaceBrush}"
                        CornerRadius="12"
                        Padding="24"
                        MaxWidth="500">
                    <StackPanel>
                        <Grid Margin="0,0,0,12">
                            <TextBlock Text="{Binding ElementName=InstallProgressBar, Path=Value, StringFormat={}{0:F1}%}"
                                       FontSize="32"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource PrimaryBrush}"
                                       HorizontalAlignment="Center"/>
                        </Grid>

                        <ProgressBar x:Name="InstallProgressBar"
                                     Style="{StaticResource ModernProgressBar}"
                                     Height="12"
                                     Maximum="100"
                                     Value="0"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Grid>

        <!-- æŒ‰é’®åŒºåŸŸ -->
        <Grid Grid.Row="2" Margin="0,32,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Button x:Name="CancelButton"
                    Grid.Column="0"
                    Content="å–æ¶ˆ"
                    Click="CancelButton_Click"
                    Style="{StaticResource SecondaryButtonStyle}"
                    HorizontalAlignment="Left"
                    Padding="24,12"
                    Width="120"/>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button x:Name="BackButton"
                        Content="â† ä¸Šä¸€æ­¥"
                        Click="BackButton_Click"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Padding="24,12"
                        Width="140"
                        Visibility="Collapsed"/>

                <Button x:Name="NextButton"
                        Content="ä¸‹ä¸€æ­¥ â†’"
                        Click="NextButton_Click"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Padding="24,12"
                        Width="140"
                        Margin="12,0,0,0"
                        Visibility="Collapsed"/>

                <Button x:Name="InstallButton"
                        Content="âœ… å¼€å§‹å®‰è£…"
                        Click="InstallButton_Click"
                        Style="{StaticResource SuccessButtonStyle}"
                        Padding="24,12"
                        Width="160"
                        Margin="12,0,0,0"
                        Visibility="Collapsed"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>

